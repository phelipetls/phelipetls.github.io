<!DOCTYPE html>
<html class="h-full" lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="description" content="O Método de Newton é um conhecido algoritmo para chegar a soluções númericas de uma equação, normalmente uma para a qual a solução não é tão trivial." />
<meta name="deploy-date" content="2022-02-01">
<meta name="publish-date" content="2019-03-17">
<meta name="last-modified-date" content="2019-03-17">
<meta name="author" content="">
<meta name="color-scheme" content="dark light">








  
  
  


<link rel="stylesheet" href="/css/main.min.css" />
<link rel="preload" href="/css/fonts.css" as="font" />
<link rel="stylesheet" href="/css/light-syntax-highlight.min.css" />
<link rel="stylesheet" href="/css/dark-syntax-highlight.min.css" disabled />

<title>
  Método de Newton | Phelipe Teles
</title>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body);
  });
</script>



<meta property="og:title" content="Método de Newton" />
<meta property="og:description" content="O Método de Newton é um conhecido algoritmo para chegar a soluções númericas de uma equação, normalmente uma para a qual a solução não é tão trivial." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://phelipetls.github.io/pt/posts/metodo-de-newton/" />
<meta property="article:published_time" content="2019-03-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-03-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Método de Newton"/>
<meta name="twitter:description" content="O Método de Newton é um conhecido algoritmo para chegar a soluções númericas de uma equação, normalmente uma para a qual a solução não é tão trivial."/>



    
      
    
  </head>

  <body class="px-4 py-8 preload text-normal bg-background flex flex-col container max-w-2xl min-h-full mx-auto transition transition-colors duration-75 ease-out" data-theme="light">
    

    
      
    

    <script>window.__setTheme = function(newTheme) {
  document.body.setAttribute("data-theme", newTheme);
  localStorage.setItem("__theme", newTheme);
  const oldTheme = newTheme === "dark" ? "light" : "dark";
  document
    .querySelector("link[href*='" + oldTheme + "']")
    .setAttribute("disabled", "");
  document
    .querySelector("link[href*='" + newTheme + "']")
    .removeAttribute("disabled");
};

const storedTheme = localStorage.getItem("__theme");

if (storedTheme) {
  window.__setTheme(storedTheme);
} else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
  window.__setTheme("dark");
}

/* Enable animations */
window.addEventListener("load", function() {
  document.body.classList.remove("preload")
})
</script>

    <header class="mb-16">
  <h1 class="mb-4">
    <div class="flex justify-between">
      <a class="border-0 font-bold" href="https://phelipetls.github.io/pt/">
        Phelipe Teles
      </a>

      <button
        id="theme-button"
        class="text-background bg-primary rounded-lg px-1 ring-divider ring-offset-background focus:ring-offset-2 focus:ring-2"
        aria-label="Mudar tema"
      >
        <svg width="24" height="24" viewBox="0 0 24 24">
          <defs>
            <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><title>Lua</title><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>

            <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><title>Sol</title><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>

          </defs>

          <use id="theme-button-svg-icon" href="#sun" />
        </svg>
      </button>
    </div>
  </h1>

  

  <nav class="flex flex-row flex-wrap gap-2" aria-label="Navegação principal"><a
        id=""
        class="text-normal "
        href="https://phelipetls.github.io/pt/"
      >
        Sobre
      </a><a
        id=""
        class="text-normal "
        href="https://phelipetls.github.io/pt/posts/"
      >
        Posts
      </a><a
        id=""
        class="text-normal "
        href="https://phelipetls.github.io/pt/projects/"
      >
        Projetos
      </a><a
        id="resume-download"
        class="text-normal "
        href="https://phelipetls.github.io/pt/"
      >
        Resumé
      </a></nav>
</header>


    <main class="flex flex-1 flex-col">
      
  <article>
    <h1>Método de Newton</h1>

    <time datetime="2019-03-17">
      Mar 17, 2019
    </time>

    <div class="sm:flex gap-2 mt-4">
      
  
    <a href="/pt/tags/matplotlib/"class="inline-flex items-center gap-1 no-underline rounded px-3 border border-divider hover:bg-highlight hover:text-background">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag" style="display: inline;"><title>Tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
matplotlib</a>
  
    <a href="/pt/tags/numpy/"class="inline-flex items-center gap-1 no-underline rounded px-3 border border-divider hover:bg-highlight hover:text-background">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag" style="display: inline;"><title>Tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
numpy</a>
  
    <a href="/pt/tags/sympy/"class="inline-flex items-center gap-1 no-underline rounded px-3 border border-divider hover:bg-highlight hover:text-background">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag" style="display: inline;"><title>Tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
sympy</a>
  


    </div>

    <hr class="my-8" />

    <p>O Método de Newton é um conhecido algoritmo para chegar a soluções númericas de
uma equação, normalmente uma para a qual a solução não é tão trivial. Por
exemplo, imagine que queiramos encontrar encontrar a raiz da função quadrática
\( x = \sqrt{5} \Rightarrow x^2 = 5 \Rightarrow x^2 - 5 = 0 \). Como
poderíamos fazer isso?</p>
<p>Newton criou um método (verdadeiramente um algoritmo) extraordinariamente
eficiente para chegar à solução, em que se faz uso de seus estudos em cálculo
diferencial.</p>
<p>Calcular \( \sqrt{5} \), hoje em dia, é trivial, basta qualquer calculadora.
Mas, como será que a calculadora faz esse cálculo? Talvez seja esse o algoritmo
que ela mesma usa. Vamos entender como isso funciona então.</p>
<p>Para melhor entendimento do problema, vejamos o gráfico da função antes.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div><p><img src="./output_1_1.png" alt="png"></p>
<p>Podemos verificar que ela intercepta o eixo x quando \( x \) é um pouquinho
acima de 2, quer dizer, quando \( x = \sqrt{5} \approx 2.23 \).</p>
<p>Ok, mas como chegamos até ali com cálculo diferencial? O raciocínio é como
segue: vamos fazer uma estimativa inicial, um valor que achamos que seja próximo
da solução. Por exemplo, 1.</p>
<p>Com esse valor, a ideia é obter a reta tangente àquele ponto, o que é algo muito
mais fácil de lidar. E, para isso, é claro que precisamos calcular \( f^{'}(1)
\), a inclinação dessa reta naquele ponto.</p>
<p>E, com ela em mãos, queremos achar onde <em>essa reta</em> intercepta o eixo x, e este
deve ser um ponto mais próximo da raiz, mas não exatamente a raiz. Isto porque
estamos calculando a raiz de uma reta pra nos aproximarmos da raiz de uma
parábola, que não é linear, é claro.</p>
<p><img src="./newtonraphson1.png" alt="Img"></p>
<p>Até então, o método não parece tão impressionante. Mas e se fizermos isso de
novo, usando como estimativa a raiz dessa reta? Acontece que se repetirmos esse
processo algumas vezes mais podemos chegar numa estimativa <em>muito</em> próxima da
solução.</p>
<h2 class="group pt-3" id="aproximação-linear">
  Aproximação Linear
  <a class="hidden text-highlight group-hover:inline" href="#aproxima%c3%a7%c3%a3o-linear">#</a>
</h2>
<p>Esse uso da reta tangente é o que se conhece por aproximação linear. Por
exemplo, retomando a função quadrática. A derivada dela é obtida pela regra da
potência, \( \frac{d(x^2)}{dx} = 2x \). Já a equação da tangente é obtida
simplesmente da equação de uma reta:</p>
<p>$$
\Delta y = f'(x)\Delta x \ (y - y_0) = f'(x_0)(x - x_0) \ y =
y_0 + m(x - x_0)
$$</p>
<p>No nosso caso, queremos achar a reta tangente quando \( x_0 = 1 \), sendo \(
f(x_0) = x^2 - 5 = 1 - 5 = -4 \). Logo, a reta que tangencia o ponto \( (1,
-4) \) é:</p>
<p>$$
y = y_0 + 2x(x - x_0) \ y = -4 + 2\cdot 1(x - 1) \ y = -4 + 2x
-2 \ y = 2x - 6
$$</p>
<p>Mas, é crucial perceber que essa é a <em>equação da reta tangente ao ponto \(
(x_0, y_0) \) da função f(x)</em>. Então, o que realmente podemos alegar é que,
para um dado número \( a \), o valor de \( f(a) \approx y(a) \), quando \(
a \approx x_0 \): a reta tangente a um dado ponto de uma função é muito próxima
da própria função para valores não muito distantes do ponto.</p>
<p>$$
f(a) \approx y_0 + m(a - x_0)
$$</p>
<p>No gráfico abaixo isso pode ser melhor visualizado. Perceba que para valores
próximos de 1, a reta tangente está bem próxima da parábola, mas vai ficando
cada vez mais distante quando x se afasta de 1. E é esse o sentido de uma
aproximação linear.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">tang</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">6</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$x^2 - 5$&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">tang</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$2x - 6$&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div><p><img src="./output_3_1.png" alt="png"></p>
<p>Nesse zoom, também podemos ver que a reta tangente ao ponto \( (1, -4) \)
cruza o eixo \( x \) um pouco mais adiante de \( 2.23 \). Mais
especificamente, quando \( 2x - 6 = 0 \Rightarrow 2x = 6 \Rightarrow x = 3 \).</p>
<p>O que é um pouco mais próximo da raiz do que a estimativa inicial 1. E é
exatamente nisso que consiste o Método de Newton, em se aproximar cada vez mais
da raiz de \( f(x) \) usando a reta que tangencia um dado ponto desta função.</p>
<p>Assim, nosso objetivo fica melhor delineado dessa forma: queremos sempre o valor
de \( x \) da reta tangente a um ponto \( (x_0, y_0) \) que faz com que \(
y = 0 \):</p>
<p>$$
y - y_0 = m(x - x_0) \text{ dividindo tudo por m e sumindo com o y: } \newline
\frac{y_0}{m} = x - x_0 \Rightarrow x = x_0 - \frac{y_0}{m} \newline
\text{ o que também pode ser escrito como: } \newline
x = x_0 - \frac{f(x_0)}{f'(x_0)} \Rightarrow x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)} \newline
$$</p>
<p>Plugando os valores de nossa estimativa inicial, obtemos:</p>
<p>$$
x = 1 - \frac{1^2 - 5}{2\cdot1} = 1 - \frac{-4}{2} = 1 - (-2) = 3
$$</p>
<p>E a ideia é usarmos o 3 como um novo \( x_0 \), e com ele calcularmos uma nova
estimativa para a raiz com a reta que tangencia \( (3, 4) \).</p>
<p>$$
x = 3 - \frac{3^2 - 5}{2\cdot3} = 3 - \frac{4}{6} = 3 - \frac{2}{3} \approx 2.333
$$</p>
<p>O que já é uma ótima aproximação de \( \sqrt{5} \). Abaixo um gráfico do que
mais ou menos aconteceu. A função laranja é a tangente ao ponto \( (1, -4) \),
e a verde ao ponto \( (3, 4) \). Veja como o intercepto-x da tangente a este
último ponto é próximo da raiz da parábola.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span>


<span class="k">def</span> <span class="nf">tangente_um</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">6</span>


<span class="k">def</span> <span class="nf">tangente_dois</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">14</span>


<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$x^2 - 5$&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">tangente_um</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$2x - 6$&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">tangente_dois</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$6x - 14$&#34;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&#34;grey&#34;</span><span class="p">,</span> <span class="s2">&#34;dashed&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&#34;grey&#34;</span><span class="p">,</span> <span class="s2">&#34;dashed&#34;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div><p><img src="./newton_visualization.png" alt="Image"></p>
<p>Seria interessante escrevermos uma função para fazer esses cálculos, e ela
inevitavelmente teria lidar com cálculo diferencial. Para isso, existe uma
biblioteca que pode nos ajudar.</p>
<h2 class="group pt-3" id="introduzindo-sympy">
  Introduzindo SymPy
  <a class="hidden text-highlight group-hover:inline" href="#introduzindo-sympy">#</a>
</h2>
<p>Essa biblioteca fornece suporte para trabalhar com álgebra simbólica. Nela
contamos com funções para calcular limites, derivadas, integrais, expandir
polinômicos, simplificar expressões etc.</p>
<p>Por exemplo, se quisermos calcular a derivada da função \( x^2 - 5 \).</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">oo</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&#34;x&#34;</span><span class="p">)</span>

<span class="n">diff</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div><pre><code>2*x
</code></pre>
<p>Podemos também calcular limites, por exemplo \( \lim_{x \to \infty}
\frac{1}{x} = 0 \)</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">limit</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
</code></pre></div><pre><code>0
</code></pre><p>Ou mesmo integrais indefinidas, \( \int x^2 , dx = \frac{x^3}{3} + c \)</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">integrate</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div><pre><code>x**3/3
</code></pre>
<p>A função assim como está não serve para retornar qualquer valor, ela
praticamente só aceita funções do próprio SymPy. Para a utilizarmos como uma
função qualquer, devemos usar <code>lambdify()</code>. Para nossos objetivos, essa última e
a função diff serão suficientes.</p>
<h2 class="group pt-3" id="um-código-para-o-algoritmo">
  Um código para o algoritmo
  <a class="hidden text-highlight group-hover:inline" href="#um-c%c3%b3digo-para-o-algoritmo">#</a>
</h2>
<p>Antes de apresentar a função em si, melhor explicar como eu a pensei.</p>
<p>Primeiramente, ela tomará três argumentos: a função, o valor para o qual
queremos uma solução, e a estimativa inicial. Por exemplo, no nosso caso, ela
tomaria os argumentos \( x^2 \), \( 5 \) e \( 1 \).</p>
<p>Em seguida, construirei simbolicamente, com estes argumentos, nossa \( f(x) \)
e sua derivada, \( f'(x) \). E com isso temos tudo que precisamos para
executarmos o método.</p>
<p>No algoritmo, decidi por 5 iterações, printando três colunas com os resultados a
cada iteração: a estimativa inicial, a nova estimativa e, por fim, a diferença
entre as duas, a fim de verificar como a cada iteração o valor de x se aproxima
mais do da raiz.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sympy.utilities.lambdify</span> <span class="kn">import</span> <span class="n">lambdify</span>


<span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">funcao</span><span class="p">,</span> <span class="n">numero</span><span class="p">,</span> <span class="n">estimativa</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">funcao</span> <span class="o">-</span> <span class="n">numero</span><span class="p">)</span>  <span class="c1"># x^2 - 5</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">diff</span><span class="p">(</span><span class="n">funcao</span> <span class="o">-</span> <span class="n">numero</span><span class="p">))</span>  <span class="c1"># 2x</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;est.    | nova est. | diferença&#34;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">nova_est</span> <span class="o">=</span> <span class="n">estimativa</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">estimativa</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="p">(</span><span class="n">estimativa</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&#34;{estimativa:.5f} | {nova_est:^ 9.5f} | {abs(nova_est - estimativa):.20f}&#34;</span>
        <span class="p">)</span>
        <span class="n">estimativa</span> <span class="o">=</span> <span class="n">nova_est</span>

    <span class="k">return</span> <span class="n">estimativa</span>


<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">O quanto erramos: {abs(np.sqrt(5) - newton(x**2, 5, 1))}&#34;</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
1.00000 |  3.00000  | 2.00000000000000000000
3.00000 |  2.33333  | 0.66666666666666651864
2.33333 |  2.23810  | 0.09523809523809534383
2.23810 |  2.23607  | 0.00202634245187471862
2.23607 |  2.23607  | 0.00000091814338532004

O quanto erramos: 1.8829382497642655e-13
</code></pre>
<p>E assim vemos que o erro foi desprezível.</p>
<p>A vantagem de usar o SymPy é que agora podemos estimar a raiz de qualquer tipo
de função. Por exemplo, a raiz cúbica de 5, ou algo mais complicado:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">O quanto erramos: {abs(5**(1/3) - newton(x**3, 5, 2))}&#34;</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
2.00000 |  1.75000  | 0.25000000000000000000
1.75000 |  1.71088  | 0.03911564625850338928
1.71088 |  1.70998  | 0.00090792482452184409
1.70998 |  1.70998  | 0.00000048224014181919
1.70998 |  1.70998  | 0.00000000000013589130

O quanto erramos: 2.220446049250313e-16
</code></pre>
<p>Uma das raízes para função \( x^4 + x^3 - x^2 - 5 \) deve ser:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newton</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
1.00000 |  1.80000  | 0.80000000000000004441
1.80000 |  1.52529  | 0.27470795979353446192
1.52529 |  1.43509  | 0.09020236587892971336
1.43509 |  1.42600  | 0.00908943849525978287
1.42600 |  1.42591  | 0.00008681126625442737

1.4259134245660217
</code></pre>
<p>Se plotarmos seu gráfico, veremos que esse é um valor razoável. Uma raiz parece
estar entre 1 e 2, e foi a que achamos. E uma outra está muito próxima de -2.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;grey&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div><p><img src="./output_17_1.png" alt="png"></p>
<p>Vamos tentar achar essa outra raiz com nossa função. Para isso, basta mudarmos
nossa estimativa inicial de forma a nos aproximarmos daquela outra raiz.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newton</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
-1.50000 | -2.98333  | 1.48333333333333339255
-2.98333 | -2.45626  | 0.52707184463468736979
-2.45626 | -2.16542  | 0.29084549734551234934
-2.16542 | -2.06890  | 0.09651451804451394167
-2.06890 | -2.05885  | 0.01005450745933744727

-2.0588469658492823
</code></pre>
<h2 class="group pt-3" id="limitações-do-método">
  Limitações do método
  <a class="hidden text-highlight group-hover:inline" href="#limita%c3%a7%c3%b5es-do-m%c3%a9todo">#</a>
</h2>
<p>Essa é uma função complicadinha e expõe algumas limitações do método que Newton
criou. Por exemplo, imagine que usemos como estimativa um valor próximo de um
mínimo, digamos que 0.5.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newton</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
0.50000 |  20.75000 | 20.25000000000000000000
20.75000 |  15.50807 | 5.24193178745838928023
15.50807 |  11.57934 | 3.92872823960125217013
11.57934 |  8.63653  | 2.94280653615018472635
8.63653 |  6.43473  | 2.20180035062548107305


6.434733086164693
</code></pre>
<p>O resultado foi bem catastrófico. É claro, não poderíamos esperar que ele fosse
infalível. Vejamos as razões pelas quais ele pode falhar.</p>
<p>Primeiro, é muito claro que o resultado final a que chegaremos depende da
estimativa inicial. Logo, se fizermos uma estimativa desarrazoada, é muito
provável que não cheguemos a uma solução pertinente.</p>
<p>Além disso, a derivada da função naquele ponto não deve ser muito pequena. No
limite, se ela for zero, teremos uma indefinição, uma divisão por zero.</p>
<p>E se ela for muito pequena, a reta tangente será muito pouco inclinada e jogará
a estimativa para muito longe da raiz. E foi isso o que aconteceu ali em cima.
Por exemplo, consideremos a função \( x^3 - x \).</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;grey&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div><p><img src="./output_20_1.png" alt="png"></p>
<p>Pelo gráfico, salta à vista que as três raízes são 0, 1 e -1. Ok, mas imagine
que queiramos estimar a raiz não-nula positiva com este método.</p>
<p>Não poderíamos escolher 0.5 como estimativa, porque isso nos jogaria para o
outro lado e acabaríamos achando algo próximo da raiz negativa:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newton</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
0.50000 | -5.00000  | 5.50000000000000000000
-5.00000 | -3.36486  | 1.63513513513513508713
-3.36486 | -2.28096  | 1.08390981119991192116
-2.28096 | -1.55628  | 0.72467848569769000022
-1.55628 | -1.04351  | 0.51277134078822550478

-1.0435052271790375
</code></pre>
<p>E se escolhêssemos algo muito perto do mínimo, aquele mesmo fiasco aconteceria.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">newton</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
</code></pre></div><pre><code>est.    | nova est. | diferença
0.60000 |  17.90000 | 17.29999999999998294697
17.90000 |  11.94680 | 5.95319767139122291155
11.94680 |  7.98552  | 3.96128197667255399494
7.98552 |  5.35691  | 2.62861103714074939575
5.35691 |  3.62500  | 1.73191328184936210732

3.624996032946096
</code></pre>
<p>Como esperado, a tangente ali é pouquíssimo inclinada, e jogou a estimativa para
muito longe, tanto que em 5 tentativas não conseguimos uma estimativa muito boa.
Veja o gráfico.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$x^3 - x$&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.432</span> <span class="o">+</span> <span class="mf">0.08</span> <span class="o">*</span> <span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;$-0.432 + 0.08x$&#34;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;grey&#34;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div><p><img src="./output_26_1.png" alt="png"></p>
<h2 class="group pt-3" id="conclusões">
  Conclusões
  <a class="hidden text-highlight group-hover:inline" href="#conclus%c3%b5es">#</a>
</h2>
<p>O interessante desse algoritmo é ser uma aplicação de cálculo diferencial. É
bastante simples sem sacrificar o lado da eficiência, mas também vimos que há
certas limitações. É claro, ele não poderia fazer milagres. Mas, hoje em dia,
basta plotar o gráfico em questão para ter uma ideia de onde estão as raízes,
como acabamos de fazer aqui com a ajuda do matplotlib.</p>


    <hr class="my-8" />

    <nav aria-label="Navegação entre posts">
      <div class="float-left sm:max-w-1/2 flex group gap-2">
        
          <div class="group-hover:text-highlight">
            ←
          </div>

          <a class="border-0" href="/pt/posts/tres-algoritmos-para-a-sequencia-de-fibonacci/" title="Post anterior">
            Três algoritmos para a sequência de Fibonacci
          </a>
        
      </div>

      <div class="float-right text-right mt-2 sm:mt-0 sm:max-w-1/2 flex group justify-end gap-2">
        
          <a class="border-0" href="/pt/posts/spread-bancario-brasileiro-r/" title="Próximo post">
            Spread bancário brasileiro: limpeza e visualização de dados
          </a>

          <div class="group-hover:text-highlight">
            →
          </div>
        
      </div>
    </nav>
  </article>

    </main>

    <footer class="mt-16 text-center">
  <div>
    Ícones de <a class="text-primary" href="https://feathericons.com/">Feather Icons</a>
  </div>

  <div>Todo conteúdo está sob a licença
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  Creative Commons Attribution 4.0
</a>
</div>
</footer>


    

    
    

    
      
      
    

    <script src="https://phelipetls.github.io/js/toggle-theme.js"></script>
    <script src="https://phelipetls.github.io/js/resume-download.js"></script>
  </body>
</html>
