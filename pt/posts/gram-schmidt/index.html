<!doctype html><html class="scroll-smooth scroll-pt-nav-height sm:scroll-pt-0
h-full text-base selection:bg-on-background selection:text-background sm:text-lg" lang=pt-br><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=deploy-date content="2022-11-05"><meta name=author content="Phelipe Teles"><meta name=color-scheme content="dark light"><style>@font-face{font-family:fira sans;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/fira-sans-v16-latin-regular.woff2)format('woff2')}@font-face{font-family:fira sans;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/fira-sans-v16-latin-600.woff2)format('woff2')}@font-face{font-family:merriweather;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/merriweather-v30-latin-regular.woff2)format('woff2')}@font-face{font-family:merriweather;font-style:normal;font-weight:700;font-display:swap;src:url(/fonts/merriweather-v30-latin-700.woff2)format('woff2')}</style><script async defer data-website-id=32b90065-c2a6-4390-9684-dfde99409815 src=https://umami-production-10b2.up.railway.app/main.js></script>
<script type=module defer src=https://phelipetls.github.io/js/bundle.min.js></script><meta name=description content="Desenvolvedor web front-end que escreve sobre a prática da programação e suas ferramentas"><meta name=publish-date content="2019-08-04"><meta name=last-modified-date content="2022-05-18"><meta name=keywords content="numpy,python,linear-algebra"><title>Processo de Gram-Schmidt com NumPy |
Phelipe Teles</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script><meta property="og:title" content="Processo de Gram-Schmidt com NumPy"><meta property="og:description" content="Em Álgebra Linear, processo de Gram-Schmidt é um algoritmo usado para tornar um conjunto de vetores perpendiculares entre si (o que também se conhece por ortogonalização)."><meta property="og:type" content="article"><meta property="og:url" content="https://phelipetls.github.io/pt/posts/gram-schmidt/"><meta property="og:image" content="https://phelipetls.github.io/pt/posts/gram-schmidt/post-image.pt.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-18T19:16:12-03:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://phelipetls.github.io/pt/posts/gram-schmidt/post-image.pt.png"><meta name=twitter:title content="Processo de Gram-Schmidt com NumPy"><meta name=twitter:description content="Em Álgebra Linear, processo de Gram-Schmidt é um algoritmo usado para tornar um conjunto de vetores perpendiculares entre si (o que também se conhece por ortogonalização)."><link rel=stylesheet href="/css/main.min.css"><link rel=stylesheet href=https://phelipetls.github.io/css/vendor/lite-yt-embed.min.css><link rel=stylesheet href=/css/dark-syntax-highlight.min.css></head><body data-preload class="ease h-full bg-background font-sans text-on-background transition-colors duration-500"><script>(()=>{window.__setTheme=s;var e=o();window.__setTheme(e),window.addEventListener("load",function(){document.body.removeAttribute("data-preload"),t(e)}),window.addEventListener("storage",function(e){const t=e.newValue;e.key==="__theme"&&window.__setTheme(t)});function s(e){if(!e)return;a(e),c(e),t(e)}function c(e){localStorage.setItem("__theme",e)}function o(){return localStorage.getItem("__theme")||"system"}function i(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n(e){return e==="system"?i():e}function a(e){const t=n(e);document.body.classList.toggle("dark",t==="dark")}function r(e){return new CustomEvent("newTheme",{detail:{themeChoice:e,theme:n(e)}})}function t(e){document.body.dispatchEvent(r(e))}})()</script><div class="relative flex h-full flex-col"><div data-nav-container class="mb-8 w-full"><div class="pt-nav-height sm:hidden"><nav class="fixed top-0 left-0 z-30 flex w-screen justify-between rounded-none border-b border-divider bg-background/90 py-4 px-horizontal-padding backdrop-blur" aria-label="Navegação principal"><div class="flex flex-row items-center gap-2 overflow-hidden"><a class=border-0 href=https://phelipetls.github.io/pt/posts/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"/></svg></a><h2 class="m-0 truncate font-sans font-normal">Processo de Gram-Schmidt com NumPy</h2></div><button data-a11y-dialog-show=sidenav class="btn btn-icon" aria-label="Abrir barra de navegação lateral"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></nav></div><div class="hidden h-full w-full sm:block"><div class="flex h-full w-full items-center justify-between bg-background pr-horizontal-padding"><div class="mx-auto flex h-full w-full max-w-content justify-between"><nav class="flex h-full justify-between overflow-x-auto px-horizontal-padding" aria-label="Navegação principal"><ul class="m-0 flex list-none flex-row flex-nowrap items-center gap-2"><li><a id=about href=https://phelipetls.github.io/pt/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>Sobre</span></a></li><li><a id=posts href=https://phelipetls.github.io/pt/posts/ aria-current=page class="bg-primary card hover:bg-primary-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span class=text-on-primary>Posts</span></a></li><li><a id=projects href=https://phelipetls.github.io/pt/projects/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>Projetos</span></a></li><li><a id=resume href=https://phelipetls.github.io/pt/resume/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>Currículo</span></a></li></ul></nav><div class="h-full py-3"><div class="flex h-full flex-row items-stretch gap-2 pl-2"><div class="relative flex h-full flex-row items-center"><span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm"><svg class="feather" viewBox="0 0 24 24" width="24" height="24"><title>Ícone do tema</title><defs><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></defs><use data-theme-select-icon href=#monitor></use></svg></span>
<select class="card h-full appearance-none bg-surface py-1 px-8 text-center" data-theme-select id=theme-select aria-label="Escolha um tema"><option value=light>Claro</option><option value=dark>Escuro</option><option value=system>Sistema</option></select>
<span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></div></div></div></div></div></div></div><aside data-a11y-dialog=sidenav aria-hidden=true class="fixed z-50 h-full w-full" style=visibility:hidden><div data-a11y-dialog-hide class="fixed inset-0 -z-1 w-full bg-neutral-700 bg-opacity-75 backdrop-blur-sm"></div><div role=document class="ml-auto h-full w-3/4 rounded-none bg-background py-0 will-change-transform"><div class="flex h-full flex-col justify-between"><div class="mb-2 flex h-nav-height items-center justify-end px-horizontal-padding"><button data-a11y-dialog-hide class="btn btn-icon" aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><nav class="flex flex-1 flex-col"><ul class="m-0 flex list-none flex-col items-center justify-center gap-4 px-horizontal-padding"><li class=w-full><a id=about href=https://phelipetls.github.io/pt/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Sobre</a></li><li class=w-full><a id=posts href=https://phelipetls.github.io/pt/posts/ aria-current=page class="card bg-primary text-on-primary hover:bg-primary-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Posts</a></li><li class=w-full><a id=projects href=https://phelipetls.github.io/pt/projects/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Projetos</a></li><li class=w-full><a id=resume href=https://phelipetls.github.io/pt/resume/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Currículo</a></li></ul></nav><div class="mb-4 flex h-12 flex-row items-center justify-center px-horizontal-padding"><div class="relative flex h-full flex-row items-center"><span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm"><svg class="feather" viewBox="0 0 24 24" width="24" height="24"><title>Ícone do tema</title><defs><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></defs><use data-theme-select-icon href=#monitor></use></svg></span>
<select class="card h-full appearance-none bg-surface py-1 px-8 text-center" data-theme-select id=theme-select aria-label="Escolha um tema"><option value=light>Claro</option><option value=dark>Escuro</option><option value=system>Sistema</option></select>
<span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></div></div></div></div></aside><main class="grid grid-cols-layout"><div class="col-full max-w-full rounded-none px-horizontal-padding pt-8 shadow-none sm:col-content sm:px-0"><article><header><h1 class="mb-4 text-4xl">Processo de Gram-Schmidt com NumPy</h1><div class="mb-4 flex flex-col gap-2"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg><div>1 min.</div></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><time datetime=2019-08-04>4 de
Agosto</time></div></div><div class="mb-4 flex flex-wrap gap-2"><a href=/pt/tags/numpy/ class="tag whitespace-nowrap">numpy</a>
<a href=/pt/tags/python/ class="tag whitespace-nowrap">python</a>
<a href=/pt/tags/linear-algebra/ class="tag whitespace-nowrap">linear-algebra</a>
<a href=/pt/tags class=tag aria-label="Todas as tags">...</a></div></header><hr class=my-8><div class="flex flex-col-reverse lg:grid lg:grid-cols-[1fr,minmax(0,1fr)]"><div data-blog-post class="[&>pre]:full-width-on-mobile
       [&>figure]:full-width-on-mobile
    [&>[data-codeblock]]:full-width-on-mobile
max-w-prose
[&>[data-codeblock]_pre]:max-sm:rounded-none
[&>[data-codeblock-with-header]]:mt-16
[&_img]:mx-auto
              [&>hr]:border-0
[&>hr]:text-center
              [&>hr]:after:content-['⁂']
[&>pre]:my-8
              [&>figure]:my-8
[&>blockquote]:my-8
              [&>figure_img]:bg-surface
          [&>figure_img]:sm:rounded
          [&>figure_video]:min-h-[15em]
      [&>figure_video]:bg-surface
        [&>figure_video]:sm:rounded
        [&_.katex-display]:overflow-x-auto
 [&_.katex-display]:overflow-y-hidden"><p>Em Álgebra Linear, processo de Gram-Schmidt é um algoritmo usado para tornar um
conjunto de vetores perpendiculares entre si (o que também se conhece por
ortogonalização).</p><p>Esse processo de ortogonalização é útil porque torna fácil numericamente
operações custosas como a inversão de uma matriz. Isso vem simplesmente do fato
do produto interno de dois vetores perpendiculares entre si ser 0.</p><p>Intuitivamente, se interpretarmos o produto interno como uma &ldquo;projeção&rdquo; de um
vetor sobre o outro, isso quer dizer que os dois vetores não tem uma
&ldquo;correlação&rdquo; em termos de direção. Geometricamente, também quer dizer que eles
estão separados por um ângulo de 90º.</p><p>Por exemplo, os três vetores abaixo são vetores ortogonais:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>ax</span> <span class=o>=</span> <span class=n>fig</span><span class=o>.</span><span class=n>add_subplot</span><span class=p>(</span><span class=n>projection</span><span class=o>=</span><span class=s1>&#39;3d&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>quiver</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>quiver</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;blue&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>quiver</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;green&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_zlim</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copiar código"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><figure><picture><source srcset=https://phelipetls.github.io/pt/posts/gram-schmidt/vetores_hue3bb076dcecbeef8808fdc465c97b094_39817_349x239_resize_q75_h2_box_3.webp type=image/webp><img src=./vetores.png alt="Vetores na terceira dimensão"></picture><figcaption class="mt-2 px-horizontal-padding text-center"><span>Vetores na terceira dimensão</span></figcaption></figure><p>Para ver isso com matrizes, vamos supor uma matriz \( Q \) cujas colunas são
vetores ortogonais com o comprimento
(
<a href=https://en.wikipedia.org/wiki/Norm_%28mathematics%29 rel=external>norma<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a>) igual a 1, o que
quer dizer que eles são <em>ortonormais</em>.</p><p>Se isso é verdade, então podemos dizer que \( Q^{T}Q = I \). E, se \( Q \)
for quadrada, então \( Q^T \) é a inversa de \( Q \)!!</p><p>Isso porque</p><p>\( q^{T}_{i}q_j = \begin{cases} 0, & \text{se } i \neq j \cr 1, & \text{se } i
= j \end{cases} \)</p><p>É dessa forma que uma operação complexa como inverter uma matriz torna-se
trivial no caso de uma matriz ortogonal.</p><p>Então entra a ideia de Gram-Schmidt, que procura transformar uma matriz \( A
\) qualquer em uma matriz com vetores ortonormais \( Q \) e uma matriz \( R
\) que conecta as duas:</p><p>$$
A = QR
$$</p><p>Como eles fazem isso? A ideia básica é a seguinte e está intimamente ligada ao
conceito de projeção. Por isso, vamos entender o que é isso antes.</p><p>Abaixo, uma imagem da projeção de um vetor \( a_1 \) sobre \( a_2 \).</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a1</span> <span class=o>=</span> <span class=n>A</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>a2</span> <span class=o>=</span> <span class=n>A</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>projection</span> <span class=o>=</span> <span class=p>(</span><span class=n>a1</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>a2</span><span class=p>)</span> <span class=o>/</span> <span class=n>a1</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>a1</span><span class=p>))</span> <span class=o>*</span> <span class=n>a2</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=n>a1</span> <span class=o>-</span> <span class=n>projection</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>arrow</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=n>a1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;red&#34;</span><span class=p>,</span> <span class=n>head_width</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>arrow</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=n>a2</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;green&#34;</span><span class=p>,</span> <span class=n>head_width</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>arrow</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>*</span><span class=n>projection</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;blue&#34;</span><span class=p>,</span> <span class=n>head_width</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>arrow</span><span class=p>(</span><span class=o>*</span><span class=n>projection</span><span class=p>,</span> <span class=o>*</span><span class=n>e</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;grey&#34;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=s2>&#34;$a_1$&#34;</span><span class=p>,</span> <span class=n>a1</span> <span class=o>+</span> <span class=mf>0.5</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=s2>&#34;$a_2$&#34;</span><span class=p>,</span> <span class=n>a2</span> <span class=o>+</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.5</span><span class=p>],</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=s2>&#34;$\hat</span><span class=si>{x}</span><span class=s2>a_2$&#34;</span><span class=p>,</span> <span class=n>projection</span> <span class=o>-</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>],</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=s2>&#34;$e = a_1 - \hat</span><span class=si>{x}</span><span class=s2>a_2$&#34;</span><span class=p>,</span> <span class=n>e</span> <span class=o>+</span> <span class=n>projection</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>],</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;Projeção de </span><span class=se>\\</span><span class=s2>( a_1 </span><span class=se>\\</span><span class=s2>) em </span><span class=se>\\</span><span class=s2>( a_2 </span><span class=se>\\</span><span class=s2>)&#34;</span><span class=p>)</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copiar código"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><figure><picture><source srcset=https://phelipetls.github.io/pt/posts/gram-schmidt/projecao-vetorial_huab14557f4571b2683bed6f589cc6b5ed_13131_377x266_resize_q75_h2_box_3.webp type=image/webp><img src=./projecao-vetorial.png alt="Projeção do vetor a1 sobre o vetor a2"></picture><figcaption class="mt-2 px-horizontal-padding text-center"><span>Projeção vetorial</span></figcaption></figure><p>Dados esses dois vetores, podemos gerar um vetor perpendicular ao \( a_2 \)
que denominaremos \( e \), que é o resultado da subtração em \( a_1 \) do
que ele tem em comum com \( a_2 \) (o \( \hat{x} \)).</p><p>Ou seja, o \( \hat{x} \) é o coeficiente de projeção, que denota o quanto \(
a_1 \) e \( a_2 \) se assemelham em termos de direção. Enquanto que \( e =
a_1 - \hat{x} a_2 \) é o erro da projeção.</p><p>Como \( e \) é perpendicular a \( a_2 \), temos que:</p><p>$$
a_2^{T} (e) = 0 \newline
a_2^{T} (a_1 - \hat{x} a_2) = 0 \newline
\hat{x}a^{T}_2a_2 = a_2^{T}a_1 \newline
\hat{x} = \frac{a^{T}_2a_1}{a^{T}_2a_2}
$$</p><p>Se você reparar bem, essa foi exatamente a conta que eu fiz para obter a
variável de nome <code>projection</code> no código acima.</p><p>Isso pode ser generaliza para um sistema de equações e é conhecido como equações
normais e é o que fundamenta o modelo clássico de regressão linear.</p><p>A fórmula é bem parecida com a de cima e a interpretação também: ela projeta o
vetor \( b \) no espaço vetorial expandido pelos vetores de \( A \).</p><p>$$
\hat{x} = (A^TA)^{-1}A^Tb
$$</p><p>O vetor projetado em \( A \) é então simplesmente \( A\hat{x} \), o produto
do que agora chamaremos matriz de projeção, \( A(A^TA)^{-1}A^T \), com o vetor
\( b \):</p><p>$$
\hat{b} = A\hat{x} = A(A^TA)^{-1}A^Tb
$$</p><p>E, para obter o erro da projeção:</p><p>$$
e = b - A\hat{x} = b - A(A^TA)^{-1}A^Tb = (I - A(A^TA)^{-1}A^T)b
$$</p><p>E assim vemos que assim como há a matriz de projeção de \( b \) sobre o
sub-espaço expandido pelos vetores de \( A \), há também a projeção de \( b
\) sobre o sub-espaço ortogonal, que é obtido ao multiplicar \( b \) com a
matriz denominada como <em>annihilator matrix</em>, \( (I - A(A^TA)^{-1}A^T) \). Essa
matriz é a <em>residual maker</em> na regressão linear. E é justamente o que iremos
precisar.</p><p>Agora, para o algoritmo propriamente dito. Vamos usar uma matriz 3x3 qualquer e
tentar torná-lo ortogonal.</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>A</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copiar código"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><pre><code>array([[5, 8, 9],
       [5, 0, 0],
       [1, 7, 6]])
</code></pre><p>O primeiro vetor não precisa ser ortogonalizado, vamos dividindo-o por seu
próprio comprimento para torná-lo normal (com norma 1).</p><p>Já o segundo, queremos ortogonalizar em relação ao primeiro. E para isso vamos
usar a <em>annhilator matrix</em>.</p><p>No caso do terceito, faremos o mesmo mas sobre o espaço expandido pelos dois
primeiros vetores.</p><p>Vamos ver se isso funciona. O código abaixo replica esse processo.</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>orthogonalize</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># vetor a ser ortogonalizado</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>A</span><span class=p>[:,</span> <span class=n>n</span><span class=p>][:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># se for o primeiro vetor, somente normalize (norma igual a um)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>b</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># se não, vamos ortogonalizar</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># espaço vetorial preenchido pelos vetores antecessores</span>
</span></span><span class=line><span class=cl>        <span class=c1># sobre o qual precisamos projetar o vetor b</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span> <span class=o>=</span> <span class=n>A</span><span class=p>[:,</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>n</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=c1># matriz identidade NxN (N = número de linhas)</span>
</span></span><span class=line><span class=cl>        <span class=n>I</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=c1># construir a annihilator matrix, para projetar o vetor b no sub-espaço</span>
</span></span><span class=line><span class=cl>        <span class=c1># ortogonal ao espaço coluna de X, em R^n</span>
</span></span><span class=line><span class=cl>        <span class=n>M</span> <span class=o>=</span> <span class=n>I</span> <span class=o>-</span> <span class=n>X</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>inv</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>X</span><span class=p>)</span> <span class=o>@</span> <span class=n>X</span><span class=o>.</span><span class=n>T</span>
</span></span><span class=line><span class=cl>        <span class=c1># fazer a projeção e retornar normalizado</span>
</span></span><span class=line><span class=cl>        <span class=n>e</span> <span class=o>=</span> <span class=n>M</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>e</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>norm</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>q</span><span class=p>(</span><span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>concatenate</span><span class=p>([</span><span class=n>orthogonalize</span><span class=p>(</span><span class=n>A</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=n>q</span><span class=p>(</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Q</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copiar código"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><pre><code>array([[ 0.70014004,  0.40635191,  0.58709629],
       [ 0.70014004, -0.55198092, -0.45290285],
       [ 0.14002801,  0.72814504, -0.67096718]])
</code></pre><p>Se tudo está correto, a multiplicação \( Q^{T}Q \) deve retornar a identidade:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Q</span><span class=o>.</span><span class=n>T</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>Q</span><span class=p>)</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copiar código"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><pre><code>array([[ 1.00000000e+00, -1.38777878e-17, -8.04911693e-16],
       [-1.38777878e-17,  1.00000000e+00,  6.66133815e-16],
       [-8.04911693e-16,  6.66133815e-16,  1.00000000e+00]])
</code></pre><p>O que felizmente é o nosso caso.</p><p>Isso também é conhecido como mudar a base de uma matriz, para uma muito mais
fácil de se lidar numericamente.</p><p>Para obter a mesma matriz Q de forma mais confiável, você pode usar a função
<code>np.linalg.qr()</code>, que vai te retornar a matriz \( Q \) que obtemos e a matriz
\( R \) que conecta \( Q \) a \( A \).</p><p>Aqui está a aula em que Gilbert Strang explica esse conceito:</p><lite-youtube videoid=uNsCkP9mgRk class=full-width-on-mobile></lite-youtube></div><aside></aside></div></article><div data-theme-copy-code-tooltip role=tooltip class="pointer-events-none absolute rounded border border-divider bg-surface px-2" style=opacity:0>Copiado<div data-theme-copy-code-tooltip-arrow class="absolute h-[8px] w-[8px] rotate-45 border-r border-b border-divider bg-surface"></div></div><hr class="full-width-on-mobile mt-8"><div class="full-width-on-mobile sm:my-8"><nav class="flex items-stretch sm:gap-4" aria-label="Navegação entre posts"><a class="sm:card flex flex-none basis-1/2 flex-col gap-2 border-0 py-4 px-horizontal-padding transition-colors duration-500 hover:bg-hover" href=/pt/posts/game-of-thrones-text-mining/><span class=text-primary><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg></span>Mineração de Texto com as legendas de Game of Thrones</a><div class="border-l border-divider sm:hidden"></div><a class="sm:card flex flex-none basis-1/2 flex-col-reverse items-end justify-end gap-2 border-0 py-4 px-horizontal-padding text-right transition-colors duration-500 hover:bg-hover" href=/pt/posts/web-scraping-de-paginas-dinamicas/>Web Scraping de páginas dinâmicas com Python
<span class=text-primary><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span></a></nav></div><hr class="full-width-on-mobile mb-8"><template data-utterances-template><div class="grid place-items-center"><div data-utterances-loading role=progressbar class="[&_svg]:animate-spin [&_svg]:duration-[1500ms]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg></div><script src=https://utteranc.es/client.js data-repo=phelipetls/phelipetls.github.io data-issue-term=pathname crossorigin=anonymous data-theme=github-light async></script></div><hr class="mt-8 hidden sm:block"></template></div></main><footer class="mt-8 border-t border-divider bg-background sm:border-0"><div class="mx-auto flex w-full max-w-content flex-col items-center gap-2 px-horizontal-padding pt-4 pb-8 sm:justify-between"><nav aria-label=Contatos class="flex gap-2"><a id=contact-email class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=mailto:phelipe_teles@hotmail.com aria-label=E-mail><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a id=contact-linkedin class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=https://linkedin.com/in/phelipeteles aria-label=LinkedIn><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a id=contact-github class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=https://github.com/phelipetls aria-label=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></nav><span class=text-center>Todo conteúdo está sob a licença
<a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0</a>.</span></div></footer></div><script src=https://phelipetls.github.io/js/post-bundle.min.js></script></body></html>