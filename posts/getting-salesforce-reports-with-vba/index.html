<!doctype html><html class=h-full lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A blog to share my interests (mostly programming)"><meta name=deploy-date content="2022-05-12"><meta name=publish-date content="2020-08-05"><meta name=last-modified-date content="2021-04-24"><meta name=author content><meta name=color-scheme content="dark light"><meta name=keywords content="salesforce,vba,excel"><link rel=icon href=/favicon.ico sizes=any><link rel=icon href=/icon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png><style>@font-face{font-family:fira sans;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firasans/v16/va9E4kDNxMZdWfMOD5VfkA.ttf)format('truetype')}@font-face{font-family:merriweather;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5Oew.ttf)format('truetype')}</style><link rel=stylesheet href="/css/main.min.css"><link rel=stylesheet href=/css/dark-syntax-highlight.min.css><title>Getting Salesforce reports with VBA | Phelipe Teles</title><meta property="og:title" content="Getting Salesforce reports with VBA"><meta property="og:description" content="For those who find themselves in an environment which heavily relies on Excel and Salesforce, you may be interested in a way to automate the process of downloading reports from inside Excel with VBA only."><meta property="og:type" content="article"><meta property="og:url" content="https://phelipetls.github.io/posts/getting-salesforce-reports-with-vba/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-05T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-24T19:44:41-03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Getting Salesforce reports with VBA"><meta name=twitter:description content="For those who find themselves in an environment which heavily relies on Excel and Salesforce, you may be interested in a way to automate the process of downloading reports from inside Excel with VBA only."></head><body data-preload class="h-full text-foreground bg-background transition transition-colors duration-500 ease-out"><script>function storeTheme(e){e&&localStorage.setItem("__theme",e)}function getStoredTheme(){return localStorage.getItem("__theme")}function setTheme(e){e==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),e==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}function dispatchNewThemeEvent(e){const t=new CustomEvent("newTheme",{detail:{theme:e}});document.body.dispatchEvent(t)}window.__setTheme=function(e){setTheme(e),storeTheme(e),dispatchNewThemeEvent(e)};const storedTheme=getStoredTheme()||"auto";window.__setTheme(storedTheme),window.addEventListener("load",function(){document.body.removeAttribute("data-preload"),dispatchNewThemeEvent(storedTheme)})</script><div data-scroll-container class="flex flex-col min-h-full"><div data-nav-container class="fixed top-0 w-full h-16 bg-background flex-shrink-0 z-30 transition-transform transition-duration-700 transition-ease-out"><div class="h-full flex items-center justify-between mx-auto max-w-5xl px-default-padding"><nav class="h-full overflow-x-auto flex items-center pr-[12px]" aria-label="Main navigation"><ul class="m-0 list-none flex items-center flex-row flex-nowrap gap-2 h-full"><li class=h-full><a href=https://phelipetls.github.io/ class="h-full
border-0
px-2
flex
relative
items-center
justify-center
overflow-hidden
after:content-['']
after:absolute
after:bottom-0
after:left-0
after:w-full
after:h-[2px]
after:bg-divider
after:opacity-0
after:-translate-x-full
hover:after:translate-x-0
hover:after:opacity-100
after:transition-opacity
after:transition-transform
after:duration-300">About</a></li><li class=h-full><a href=https://phelipetls.github.io/posts/ class="h-full
border-0
px-2
flex
relative
items-center
justify-center
overflow-hidden
after:content-['']
after:absolute
after:bottom-0
after:left-0
after:w-full
after:h-[2px]
active
after:bg-primary">Posts</a></li><li class=h-full><a href=https://phelipetls.github.io/projects/ class="h-full
border-0
px-2
flex
relative
items-center
justify-center
overflow-hidden
after:content-['']
after:absolute
after:bottom-0
after:left-0
after:w-full
after:h-[2px]
after:bg-divider
after:opacity-0
after:-translate-x-full
hover:after:translate-x-0
hover:after:opacity-100
after:transition-opacity
after:transition-transform
after:duration-300">Projects</a></li><li class=h-full><a href=https://phelipetls.github.io/resume/ class="h-full
border-0
px-2
flex
relative
items-center
justify-center
overflow-hidden
after:content-['']
after:absolute
after:bottom-0
after:left-0
after:w-full
after:h-[2px]
after:bg-divider
after:opacity-0
after:-translate-x-full
hover:after:translate-x-0
hover:after:opacity-100
after:transition-opacity
after:transition-transform
after:duration-300">Resum√©</a></li></ul></nav><div class="relative flex items-center gap-2"><div class="absolute h-full top-0 -left-[24px] w-[24px] bg-gradient-to-r from-[rgba(255,255,255,0.001)] dark:from-[rgba(0,0,0,0.001)] to-background pointer-events-none"></div><button data-theme-button class="btn btn-icon" aria-label="Change theme" aria-expanded=false aria-controls=theme-menu aria-haspopup=true><svg style="width:var(--icon-size);height:var(--icon-size)" viewBox="0 0 24 24"><title>Theme icon</title><defs><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></defs>
<use data-theme-button-svg-icon href=#sun></svg></button></div><ul data-theme-menu id=theme-menu class="absolute top-0 left-0 bg-background border border-divider rounded z-50 shadow-xl shadow-divider/50 flex flex-col list-none m-0 text-lg" style=visibility:hidden;opacity:0;pointer-events:none;--icon-size:24px role=menu aria-orientation=vertical aria-activedescendant=theme-option-auto aria-label="Theme options" tabindex=-1><li class="px-2 py-1 m-0 cursor-pointer flex items-center gap-1" id=theme-option-light data-theme=light role=menuitem tabindex=-1><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>Light</li><li class="px-2 py-1 m-0 cursor-pointer flex items-center gap-1" id=theme-option-dark data-theme=dark role=menuitem tabindex=-1><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>Dark</li><li class="px-2 py-1 m-0 cursor-pointer flex items-center gap-1" id=theme-option-auto data-theme=auto role=menuitem tabindex=-1><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>System</li></ul></div></div><div class="mt-36 mb-16 px-default-padding flex-1 max-w-5xl flex container mx-auto"><main class="flex flex-1 shrink-0 flex-col w-full"><article><header><h1 class="text-4xl mb-4">Getting Salesforce reports with VBA</h1><div class="flex flex-col gap-2 mb-4" style=--icon-size:24px><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg><div>9 min.</div></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><time datetime=2020-08-05>August 05, 2020</time></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg><div>Last modified at
<time datetime=2021-04-24>April 24, 2021</time></div></div></div></header><div class=mb-4><div class="flex flex-wrap gap-2 py-2"><a href=/tags/salesforce/ class="no-underline rounded-full border-2 px-4 py-1/2">salesforce</a>
<a href=/tags/vba/ class="no-underline rounded-full border-2 px-4 py-1/2">vba</a>
<a href=/tags/excel/ class="no-underline rounded-full border-2 px-4 py-1/2">excel</a>
<a href=/tags class="no-underline rounded-full border-2 px-4 py-1/2">...</a></div></div><hr class=my-8><section data-blog-post class=max-w-prose><p>For those who find themselves in an environment which heavily relies on Excel
and Salesforce, you may be interested in a way to automate the process of
downloading reports from inside Excel with VBA only.</p><p>I think there are probably better tools for the job, like Apex, SOQL query or a
better programming language. I
<a href=https://github.com/reportforce>created a Python package for this purpose</a>
but
I didn&rsquo;t use it so much because it&rsquo;s hard to integrate with Excel.</p><p>Instead, I looked into a way to do something similar with VBA and I managed to
do it. In this post I&rsquo;ll share this with you.</p><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=authentication>Authentication
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#authentication><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>The more painless way I know of to
<a href=https://developer.salesforce.com/docs/atlas.en-us.api_asynch.meta/api_asynch/asynch_api_quickstart_login.htm>authenticate your requests for a Salesforce web service is via SOAP API</a>
,
with username, password and a security token.</p><p>It returns a bunch of XML in the response, but we will only need the session id
(a JWT) inside of it. This is what the function below does.</p><p>From here onwards, we will need to authenticate every request by passing the
header <code>Authorization: Bearer $sessionId</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Function</span> <span class=nf>SalesforceLogin</span><span class=p>(</span><span class=n>Username</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=n>Password</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=n>SecurityToken</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>)</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Request</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Request</span> <span class=o>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s>&#34;MSXML2.XMLHTTP.6.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>XMLBody</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>XMLResponse</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>XMLBody</span> <span class=o>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s>&#34;MSXML2.DOMDocument.6.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>XMLResponse</span> <span class=o>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s>&#34;MSXML2.DOMDocument.6.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Url</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Body</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Response</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Url</span> <span class=o>=</span> <span class=s>&#34;https://login.salesforce.com/services/Soap/u/47.0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Body</span> <span class=o>=</span> <span class=s>&#34;&lt;?xml version=&#34;&#34;1.0&#34;&#34; encoding=&#34;&#34;utf-8&#34;&#34; ?&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;&lt;env:Envelope xmlns:xsd=&#34;&#34;http://www.w3.org/2001/XMLSchema&#34;&#34;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;    xmlns:xsi=&#34;&#34;http://www.w3.org/2001/XMLSchema-instance&#34;&#34;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;    xmlns:env=&#34;&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&#34;&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;  &lt;env:Body&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;    &lt;n1:login xmlns:n1=&#34;&#34;urn:partner.soap.sforce.com&#34;&#34;&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;      &lt;n1:username&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>Username</span> <span class=o>&amp;</span> <span class=s>&#34;&lt;/n1:username&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;      &lt;n1:password&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>Password</span> <span class=o>&amp;</span> <span class=n>SecurityToken</span> <span class=o>&amp;</span> <span class=s>&#34;&lt;/n1:password&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;    &lt;/n1:login&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;  &lt;/env:Body&gt;&#34;</span> <span class=o>&amp;</span> <span class=n>vbNewLine</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>           <span class=s>&#34;&lt;/env:Envelope&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>XMLBody</span><span class=p>.</span><span class=n>LoadXML</span> <span class=n>Body</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>Open</span> <span class=s>&#34;POST&#34;</span><span class=p>,</span> <span class=n>Url</span><span class=p>,</span> <span class=k>False</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>setRequestHeader</span> <span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;text/xml&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>setRequestHeader</span> <span class=s>&#34;SOAPAction&#34;</span><span class=p>,</span> <span class=s>&#34;login&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>send</span> <span class=n>XMLBody</span><span class=p>.</span><span class=n>XML</span>
</span></span><span class=line><span class=cl>    <span class=n>Response</span> <span class=o>=</span> <span class=n>Request</span><span class=p>.</span><span class=n>responseText</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>XMLResponse</span><span class=p>.</span><span class=n>LoadXML</span> <span class=n>Response</span>
</span></span><span class=line><span class=cl>    <span class=n>XMLResponse</span><span class=p>.</span><span class=n>setProperty</span> <span class=s>&#34;SelectionNamespaces&#34;</span><span class=p>,</span> <span class=s>&#34;xmlns:soapenv=&#34;&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&#34; xmlns:urn=&#34;&#34;urn:partner.soap.sforce.com&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>SessionId</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=n>SessionId</span> <span class=o>=</span> <span class=n>XMLResponse</span><span class=p>.</span><span class=n>SelectSingleNode</span><span class=p>(</span><span class=s>&#34;//urn:result/urn:sessionId&#34;</span><span class=p>).</span><span class=n>Text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>SalesforceLogin</span> <span class=o>=</span> <span class=n>SessionId</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Request</span> <span class=o>=</span> <span class=k>Nothing</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Function</span>
</span></span></code></pre></div><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=parsing-json-inside-vba>Parsing JSON inside VBA?
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#parsing-json-inside-vba><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Now, to get an actual report inside Excel we will need to use the Analytics API.
So far, we didn&rsquo;t had to rely on any external tools, there is an XML parser
inside VBA, but not a JSON parser at least that I know of. So we&rsquo;re in trouble
here because that&rsquo;s what Analytics speaks.</p><p>Fortunately, there is a
<a href=https://github.com/VBA-tools/VBA-JSON>JSON parser implementation for VBA</a>
which works flawlessly. You just need to download
<a href=https://raw.githubusercontent.com/VBA-tools/VBA-JSON/master/JsonConverter.bas>this file</a>
and import it as a module.</p><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=unfortunate-api-limitations>Unfortunate API limitations
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#unfortunate-api-limitations><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>This API unfortunately have a
<a href=https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_limits_limitations.htm>critical limitation</a>
,
which is to return only a maximum of 2000 rows per report. Also, there is no way
to filter by row limits.</p><p>This almost turns it useless. The only way I know of is to use a column which
has only unique values and exclude already seen values with a filter, which is
what we&rsquo;ll gonna do.</p><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=getting-report-metadata>Getting report metadata
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#getting-report-metadata><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>To be able to filter a report, we will need to fetch its metadata, which is a
huge JSON with key-value pairs describing the report.</p><p>We can get it with a <code>GET</code> request to
<code>https://$YOUR_INSTANCE_URL/services/data/v47.0/analytics/reports/$REPORT_ID/describe</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Function</span> <span class=nf>GetMetadata</span><span class=p>(</span><span class=n>ReportId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> <span class=n>SessionId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>)</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Request</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Request</span> <span class=o>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s>&#34;MSXML2.XMLHTTP.6.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Response</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Url</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; NOTE: You will need your organization URL here
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=n>Url</span> <span class=o>=</span>  <span class=n>YOUR_INSTANCE_URL</span> <span class=o>&amp;</span> <span class=s>&#34;/services/data/v47.0/analytics/reports/&#34;</span> <span class=o>&amp;</span> <span class=n>ReportId</span> <span class=o>&amp;</span> <span class=s>&#34;/describe&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>Open</span> <span class=s>&#34;GET&#34;</span><span class=p>,</span> <span class=n>Url</span><span class=p>,</span> <span class=k>False</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>setRequestHeader</span> <span class=s>&#34;Authorization&#34;</span><span class=p>,</span> <span class=s>&#34;Bearer &#34;</span> <span class=o>&amp;</span> <span class=n>SessionId</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>send</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>GetMetadata</span> <span class=o>=</span> <span class=n>Request</span><span class=p>.</span><span class=n>responseText</span>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Function</span>
</span></span></code></pre></div><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=getting-an-individual-report>Getting an individual report
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#getting-an-individual-report><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>With the function below, you will be able to get the report in JSON format.</p><p>This is achieved with a <code>POST</code> request to
<code>https://$YOUR_INSTANCE_URL/services/data/v47.0/analytics/reports/$REPORT_ID</code>,
optional metadata goes into the request body, this is what we use to filter the
report.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Function</span> <span class=nf>GetReport</span><span class=p>(</span><span class=n>ReportId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                   <span class=n>SessionId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                   <span class=k>Optional</span> <span class=n>Metadata</span> <span class=ow>As</span> <span class=kt>String</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>)</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Request</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Request</span> <span class=o>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s>&#34;MSXML2.XMLHTTP.6.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Response</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Url</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Url</span> <span class=o>=</span> <span class=n>YOUR_INSTANCE_URL</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>          <span class=s>&#34;services/data/v47.0/analytics/reports/&#34;</span> <span class=o>&amp;</span> <span class=n>ReportId</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>Open</span> <span class=s>&#34;POST&#34;</span><span class=p>,</span> <span class=n>Url</span><span class=p>,</span> <span class=k>False</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>setRequestHeader</span> <span class=s>&#34;Authorization&#34;</span><span class=p>,</span> <span class=s>&#34;Bearer &#34;</span> <span class=o>&amp;</span> <span class=n>SessionId</span>
</span></span><span class=line><span class=cl>    <span class=n>Request</span><span class=p>.</span><span class=n>setRequestHeader</span> <span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>If</span> <span class=n>Metadata</span> <span class=o>&lt;&gt;</span> <span class=s>&#34;&#34;</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>        <span class=n>Request</span><span class=p>.</span><span class=n>send</span> <span class=p>(</span><span class=n>Metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Else</span>
</span></span><span class=line><span class=cl>        <span class=n>Request</span><span class=p>.</span><span class=n>send</span>
</span></span><span class=line><span class=cl>    <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Response</span> <span class=o>=</span> <span class=n>Request</span><span class=p>.</span><span class=n>responseText</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>GetReport</span> <span class=o>=</span> <span class=n>Response</span>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Function</span>
</span></span></code></pre></div><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=writing-the-data-into-a-worksheet>Writing the data into a worksheet
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#writing-the-data-into-a-worksheet><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>Now we need to extract the data and write it into a worksheet.</p><p><a href=https://developer.salesforce.com/docs/atlas.en-us.api_analytics.meta/api_analytics/sforce_analytics_rest_api_factmap_example.htm>Every thing we need is inside the <code>factMap</code> key</a>
.
This can get complex if we intend to cover matrix and summary reports, which has
groupings etc., but tabular reports are much simpler.</p><p>What we need to do is to iterate through the values at <code>factMap.T!T.rows</code> and,
for each row, get every value inside <code>.dataCells</code> array.</p><p>This approach will only cover tabular reports, you can take a look at the
<a href=https://github.com/phelipetls/reportforce/tree/master/reportforce/helpers>reportforce source code</a>
if you need to cover these. By the way, there is an option to export to an Excel
(but not to write to a worksheet, obviously).</p><p>The below function takes care of this, its job is to go through every cell and
store it in an array, and then append that array to a worksheet range starting
from column A.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Function</span> <span class=nf>WriteIntoWorksheet</span><span class=p>(</span><span class=n>Report</span> <span class=ow>As</span> <span class=n>Dictionary</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>WorksheetName</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>ColumnLabels</span> <span class=ow>As</span> <span class=kt>Variant</span><span class=p>)</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Rows</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Columns</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ColumnInfo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Columns</span> <span class=o>=</span> <span class=n>Report</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;detailColumns&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>ColumnInfo</span> <span class=o>=</span> <span class=n>Report</span><span class=p>(</span><span class=s>&#34;reportExtendedMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;detailColumnInfo&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Rows</span> <span class=o>=</span> <span class=n>Report</span><span class=p>(</span><span class=s>&#34;factMap&#34;</span><span class=p>)(</span><span class=s>&#34;T!T&#34;</span><span class=p>)(</span><span class=s>&#34;rows&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Total_Rows</span> <span class=ow>As</span> <span class=kt>Long</span><span class=p>:</span> <span class=n>Total_Rows</span> <span class=o>=</span> <span class=n>Rows</span><span class=p>.</span><span class=n>Count</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Total_Columns</span> <span class=ow>As</span> <span class=kt>Long</span><span class=p>:</span> <span class=n>Total_Columns</span> <span class=o>=</span> <span class=n>Columns</span><span class=p>.</span><span class=n>Count</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>If</span> <span class=n>Total_Rows</span> <span class=o>=</span> <span class=n>0</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>        <span class=k>Exit</span> <span class=k>Function</span>
</span></span><span class=line><span class=cl>    <span class=nf>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Table</span><span class=p>()</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>    <span class=k>ReDim</span> <span class=n>Table</span><span class=p>(</span><span class=n>Total_Rows</span> <span class=o>-</span> <span class=n>1</span><span class=p>,</span> <span class=n>Total_Columns</span> <span class=o>-</span> <span class=n>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>row</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>cell</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>i</span> <span class=ow>As</span> <span class=kt>Long</span><span class=p>:</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>j</span> <span class=ow>As</span> <span class=kt>Long</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>dataType</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>For</span> <span class=k>Each</span> <span class=n>row</span> <span class=ow>In</span> <span class=n>Rows</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=n>0</span>
</span></span><span class=line><span class=cl>        <span class=k>For</span> <span class=k>Each</span> <span class=n>cell</span> <span class=ow>In</span> <span class=n>row</span><span class=p>(</span><span class=s>&#34;dataCells&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>dataType</span> <span class=o>=</span> <span class=n>ColumnInfo</span><span class=p>(</span><span class=n>Columns</span><span class=p>(</span><span class=n>j</span> <span class=o>+</span> <span class=n>1</span><span class=p>))(</span><span class=s>&#34;dataType&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c>&#39; If column is a date, get value property;
</span></span></span><span class=line><span class=cl><span class=c></span>            <span class=c>&#39; Excel understands it better
</span></span></span><span class=line><span class=cl><span class=c></span>            <span class=k>If</span> <span class=n>dataType</span> <span class=o>=</span> <span class=s>&#34;date&#34;</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>                <span class=n>Table</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>cell</span><span class=p>(</span><span class=s>&#34;value&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>Else</span>
</span></span><span class=line><span class=cl>                <span class=n>Table</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span> <span class=o>=</span> <span class=n>cell</span><span class=p>(</span><span class=s>&#34;label&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>j</span> <span class=o>=</span> <span class=n>j</span> <span class=o>+</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>        <span class=k>Next</span> <span class=n>cell</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>    <span class=k>Next</span> <span class=n>row</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>With</span> <span class=n>ThisWorkbook</span><span class=p>.</span><span class=n>Worksheets</span><span class=p>(</span><span class=n>WorksheetName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>Dim</span> <span class=n>LastRow</span> <span class=ow>As</span> <span class=kt>Long</span>
</span></span><span class=line><span class=cl>        <span class=n>LastRow</span> <span class=o>=</span> <span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=s>&#34;A:A&#34;</span><span class=p>).</span><span class=n>Find</span><span class=p>(</span><span class=s>&#34;*&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                                     <span class=n>SearchOrder</span><span class=p>:</span><span class=o>=</span><span class=n>xlByRows</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                                     <span class=n>SearchDirection</span><span class=p>:</span><span class=o>=</span><span class=n>xlPrevious</span><span class=p>).</span><span class=n>row</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Range</span><span class=p>(.</span><span class=n>Cells</span><span class=p>(</span><span class=n>LastRow</span> <span class=o>+</span> <span class=n>1</span><span class=p>,</span> <span class=s>&#34;A&#34;</span><span class=p>),</span> _
</span></span><span class=line><span class=cl>               <span class=p>.</span><span class=n>Cells</span><span class=p>(</span><span class=n>Total_Rows</span> <span class=o>+</span> <span class=n>LastRow</span><span class=p>,</span> <span class=n>Total_Columns</span><span class=p>))</span> <span class=o>=</span> <span class=n>Table</span>
</span></span><span class=line><span class=cl>    <span class=k>End</span> <span class=k>With</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>WriteIntoWorksheet</span> <span class=o>=</span> <span class=n>Table</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Function</span>
</span></span></code></pre></div><p>We also need to get the values at <code>.reportMetadata.detailColumns</code> and
<code>reportExtendedMetadata.detailColumnInfo</code> to check how many columns the report
have and to extract the value at <code>.value</code> if it is a date.</p><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=getting-the-entire-report>Getting the entire report
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#getting-the-entire-report><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>To get the entire report, the key thing to overcome the API limitations is a key
called <code>.allData</code>, which will be <code>true</code> only if we got all the data from the
API.</p><p>So we get the first 2000 rows and, if <code>.allData</code> is <code>false</code>, we get the values
of an identifier column, filter them out and request a new report, until we get
all data.</p><p>We will modify the keys <code>.reportMetadata.standardDateFilter</code> and
<code>.reportMetadata.reportFilters</code>, to filter dates and other filters respectively.</p><p>If your report has a boolean filter, it&rsquo;s likely that you&rsquo;ll need to change it
because we will insert new filters. This is already done in the code by changing
the value at <code>.reportMetadata.reportBooleanFilter</code>, so you only need to pass it
as a parameter.</p><p>The function looks way more involved because we have to get the report headers
(the <code>label</code> property of each object inside
<code>.reportExtendedMetadata.detailColumnInfo</code>, the ones you see in the browser).</p><p>We also need the identifier column API name (an internal value), which we will
need to filter it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Sub</span> <span class=nf>DownloadEntireReport</span><span class=p>(</span><span class=n>ReportId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=n>WorksheetName</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=n>SessionId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=k>Optional</span> <span class=n>IdentifierColumn</span> <span class=ow>As</span> <span class=kt>String</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=k>Optional</span> <span class=n>BooleanFilter</span> <span class=ow>As</span> <span class=kt>String</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=k>Optional</span> <span class=n>startDate</span> <span class=ow>As</span> <span class=kt>String</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                         <span class=k>Optional</span> <span class=n>endDate</span> <span class=ow>As</span> <span class=kt>String</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Report</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ReportMetadata</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>ReportMetadata</span> <span class=o>=</span> <span class=n>JsonConverter</span><span class=p>.</span><span class=n>ParseJson</span><span class=p>(</span><span class=n>GetMetadata</span><span class=p>(</span><span class=n>ReportId</span><span class=p>,</span> <span class=n>SessionId</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>IdentifierColumnApiName</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>IdentifierColumnPosition</span> <span class=ow>As</span> <span class=kt>Long</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Col</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>i</span> <span class=ow>As</span> <span class=kt>Long</span><span class=p>:</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ColumnDetails</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>ColumnDetails</span> <span class=o>=</span> <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportExtendedMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;detailColumnInfo&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; This is an array to store the column headers
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>Dim</span> <span class=n>ColumnLabels</span><span class=p>()</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>    <span class=k>ReDim</span> <span class=n>ColumnLabels</span><span class=p>(</span><span class=n>0</span><span class=p>,</span> <span class=n>ColumnDetails</span><span class=p>.</span><span class=n>Count</span> <span class=o>-</span> <span class=n>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; Collection the column headers
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>For</span> <span class=k>Each</span> <span class=n>Col</span> <span class=ow>In</span> <span class=n>ColumnDetails</span><span class=p>.</span><span class=n>Keys</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>ColumnLabels</span><span class=p>(</span><span class=n>0</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=o>=</span> <span class=n>ColumnDetails</span><span class=p>(</span><span class=n>Col</span><span class=p>)(</span><span class=s>&#34;label&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&#39; Remember which column matches the identifier column label
</span></span></span><span class=line><span class=cl><span class=c></span>        <span class=k>If</span> <span class=n>ColumnDetails</span><span class=p>(</span><span class=n>Col</span><span class=p>)(</span><span class=s>&#34;label&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>IdentifierColumn</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>            <span class=n>IdentifierColumnApiName</span> <span class=o>=</span> <span class=n>Col</span>
</span></span><span class=line><span class=cl>            <span class=n>IdentifierColumnPosition</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=n>1</span>
</span></span><span class=line><span class=cl>    <span class=k>Next</span> <span class=n>Col</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; Write column headers starting from A1
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>With</span> <span class=n>ThisWorkbook</span><span class=p>.</span><span class=n>Worksheets</span><span class=p>(</span><span class=n>WorksheetName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Range</span><span class=p>(.</span><span class=n>Cells</span><span class=p>(</span><span class=n>1</span><span class=p>,</span> <span class=s>&#34;A&#34;</span><span class=p>),</span> <span class=p>.</span><span class=n>Cells</span><span class=p>(</span><span class=n>1</span><span class=p>,</span> <span class=n>ColumnDetails</span><span class=p>.</span><span class=n>Count</span><span class=p>))</span> <span class=o>=</span> <span class=n>ColumnLabels</span>
</span></span><span class=line><span class=cl>    <span class=k>End</span> <span class=k>With</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ReportMetadataJson</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>:</span> <span class=n>ReportMetadataJson</span> <span class=o>=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; Setting date filters, if any
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>If</span> <span class=n>startDate</span> <span class=o>&lt;&gt;</span> <span class=s>&#34;&#34;</span> <span class=ow>And</span> <span class=n>endDate</span> <span class=o>&lt;&gt;</span> <span class=s>&#34;&#34;</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;standardDateFilter&#34;</span><span class=p>)(</span><span class=s>&#34;durationValue&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=s>&#34;CUSTOM&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;standardDateFilter&#34;</span><span class=p>)(</span><span class=s>&#34;startDate&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>Format</span><span class=p>(</span><span class=n>startDate</span><span class=p>,</span> <span class=s>&#34;yyyy-mm-dd&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;standardDateFilter&#34;</span><span class=p>)(</span><span class=s>&#34;endDate&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>Format</span><span class=p>(</span><span class=n>endDate</span><span class=p>,</span> <span class=s>&#34;yyyy-mm-dd&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadataJson</span> <span class=o>=</span> <span class=n>JsonConverter</span><span class=p>.</span><span class=n>ConvertToJson</span><span class=p>(</span><span class=n>ReportMetadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; Get first 2000 rows
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>Set</span> <span class=n>Report</span> <span class=o>=</span> <span class=n>JsonConverter</span><span class=p>.</span><span class=n>ParseJson</span><span class=p>(</span><span class=n>GetReport</span><span class=p>(</span><span class=n>ReportId</span><span class=p>,</span> <span class=n>SessionId</span><span class=p>,</span> <span class=n>ReportMetadataJson</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ReportTable</span> <span class=ow>As</span> <span class=kt>Variant</span>
</span></span><span class=line><span class=cl>    <span class=n>ReportTable</span> <span class=o>=</span> <span class=n>WriteIntoWorksheet</span><span class=p>(</span><span class=n>Report</span><span class=p>,</span> <span class=n>WorksheetName</span><span class=p>,</span> <span class=n>ColumnLabels</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&#39; Getting Remaining Values By Filtering Out Old Values
</span></span></span><span class=line><span class=cl><span class=c></span>
</span></span><span class=line><span class=cl>    <span class=k>If</span> <span class=n>BooleanFilter</span> <span class=o>&lt;&gt;</span> <span class=s>&#34;&#34;</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;reportBooleanFilter&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>BooleanFilter</span>
</span></span><span class=line><span class=cl>    <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>IdentifierColumnValues</span>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>IdentifierColumnFilter</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>:</span> <span class=n>IdentifierColumnFilter</span> <span class=o>=</span> <span class=s>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>Filters</span> <span class=ow>As</span> <span class=n>Scripting</span><span class=p>.</span><span class=n>Dictionary</span>
</span></span><span class=line><span class=cl>    <span class=k>Set</span> <span class=n>Filters</span> <span class=o>=</span> <span class=k>New</span> <span class=n>Dictionary</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Dim</span> <span class=n>ReportFilters</span> <span class=ow>As</span> <span class=kt>Object</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>Do</span> <span class=n>Until</span> <span class=n>Report</span><span class=p>(</span><span class=s>&#34;allData&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>IdentifierColumnValues</span> <span class=o>=</span> <span class=n>GetValuesAtColumn</span><span class=p>(</span><span class=n>ReportTable</span><span class=p>,</span> <span class=n>IdentifierColumnPosition</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>IdentifierColumnFilter</span> <span class=o>=</span> <span class=n>IdentifierColumnFilter</span> <span class=o>&amp;</span> _
</span></span><span class=line><span class=cl>                                 <span class=n>Join</span><span class=p>(</span><span class=n>Application</span><span class=p>.</span><span class=n>Transpose</span><span class=p>(</span><span class=n>IdentifierColumnValues</span><span class=p>),</span> <span class=s>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>RemoveAll</span>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>Add</span> <span class=s>&#34;filterType&#34;</span><span class=p>,</span> <span class=s>&#34;fieldValue&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>Add</span> <span class=s>&#34;isRunPageEditable&#34;</span><span class=p>,</span> <span class=k>True</span>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>Add</span> <span class=s>&#34;column&#34;</span><span class=p>,</span> <span class=n>IdentifierColumnApiName</span>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>Add</span> <span class=s>&#34;operator&#34;</span><span class=p>,</span> <span class=s>&#34;notEqual&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Filters</span><span class=p>.</span><span class=n>Add</span> <span class=s>&#34;value&#34;</span><span class=p>,</span> <span class=n>IdentifierColumnFilter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>Set</span> <span class=n>ReportFilters</span> <span class=o>=</span> <span class=n>ReportMetadata</span><span class=p>(</span><span class=s>&#34;reportMetadata&#34;</span><span class=p>)(</span><span class=s>&#34;reportFilters&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&#39; If IdentifierColumn was already added, just change the filter value
</span></span></span><span class=line><span class=cl><span class=c></span>        <span class=k>If</span> <span class=n>ReportFilters</span><span class=p>(</span><span class=n>ReportFilters</span><span class=p>.</span><span class=n>Count</span><span class=p>)(</span><span class=s>&#34;column&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>IdentifierColumn</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>            <span class=n>ReportFilters</span><span class=p>(</span><span class=n>ReportFilters</span><span class=p>.</span><span class=n>Count</span><span class=p>)(</span><span class=s>&#34;value&#34;</span><span class=p>)</span> <span class=o>=</span> <span class=n>IdentifierColumnFilter</span>
</span></span><span class=line><span class=cl>        <span class=k>Else</span>
</span></span><span class=line><span class=cl>            <span class=n>ReportFilters</span><span class=p>.</span><span class=n>Add</span> <span class=n>Filters</span>
</span></span><span class=line><span class=cl>        <span class=k>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ReportMetadataJson</span> <span class=o>=</span> <span class=n>JsonConverter</span><span class=p>.</span><span class=n>ConvertToJson</span><span class=p>(</span><span class=n>ReportMetadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>Set</span> <span class=n>Report</span> <span class=o>=</span> <span class=n>JsonConverter</span><span class=p>.</span><span class=n>ParseJson</span><span class=p>(</span><span class=n>GetReport</span><span class=p>(</span><span class=n>ReportId</span><span class=p>,</span> <span class=n>SessionId</span><span class=p>,</span> <span class=n>ReportMetadataJson</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ReportTable</span> <span class=o>=</span> <span class=n>WriteIntoWorksheet</span><span class=p>(</span><span class=n>Report</span><span class=p>,</span> <span class=n>WorksheetName</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>Loop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Sub</span>
</span></span></code></pre></div><p>To do the filter, we create a <code>Filters</code> dictionary to store all key-value pairs
we need, then add it to the <code>reportFilters</code> object, and change its value in
later iterations. Then we convert the metadata into a JSON string, get a new
filtered report and repeat the loop until we get all data.</p><p>Also notice that I use a custom function to get all values at a given column,
<code>GetValuesAtColumn</code>.</p><p><a href=https://gist.github.com/phelipetls/57a27f529561eefe73633093c737b7e0>Get the full source code in this GitHub gist</a>
.</p><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=how-to-use-it>How to use it
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#how-to-use-it><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>It&rsquo;s up to you how you&rsquo;re gonna use this code. Here&rsquo;s an example.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vb data-lang=vb><span class=line><span class=cl><span class=k>Sub</span> <span class=nf>DownloadReports</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>Dim</span> <span class=n>Username</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> <span class=n>Password</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>,</span> <span class=n>SecurityToken</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Username</span> <span class=o>=</span> <span class=s>&#34;username&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>Password</span> <span class=o>=</span> <span class=s>&#34;password&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>SecurityToken</span> <span class=o>=</span> <span class=s>&#34;secret&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>Dim</span> <span class=n>SessionId</span> <span class=ow>As</span> <span class=kt>String</span>
</span></span><span class=line><span class=cl>  <span class=n>SessionId</span> <span class=o>=</span> <span class=n>SalesforceLogin</span><span class=p>(</span><span class=n>Username</span><span class=p>,</span> <span class=n>Password</span><span class=p>,</span> <span class=n>SecurityToken</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>If</span> <span class=n>IsEmpty</span><span class=p>(</span><span class=n>SessionId</span><span class=p>)</span> <span class=k>Then</span>
</span></span><span class=line><span class=cl>      <span class=n>MsgBox</span> <span class=s>&#34;Authentication Error&#34;</span>
</span></span><span class=line><span class=cl>      <span class=k>Exit</span> <span class=k>Sub</span>
</span></span><span class=line><span class=cl>  <span class=nf>End</span> <span class=k>If</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>Dim</span> <span class=n>ReportId</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>:</span> <span class=n>ReportId</span> <span class=o>=</span> <span class=s>&#34;REPORT_ID&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>Dim</span> <span class=n>WorksheetName</span> <span class=ow>As</span> <span class=kt>String</span><span class=p>:</span> <span class=n>WorksheetName</span> <span class=o>=</span> <span class=s>&#34;MY_REPORT&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>Call</span> <span class=n>DownloadEntireReport</span><span class=p>(</span><span class=n>ReportId</span><span class=p>,</span> <span class=n>WorksheetName</span><span class=p>,</span> <span class=n>SessionId</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>IdentifierColumn</span><span class=p>:</span><span class=o>=</span><span class=s>&#34;N√∫mero do caso&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>BooleanFilter</span><span class=p>:</span><span class=o>=</span><span class=s>&#34;1 AND 2 AND (3 OR 4)&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>startDate</span><span class=p>:</span><span class=o>=</span><span class=s>&#34;01/07/2020&#34;</span><span class=p>,</span> _
</span></span><span class=line><span class=cl>                            <span class=n>endDate</span><span class=p>:</span><span class=o>=</span><span class=s>&#34;31/07/2020&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>End</span> <span class=k>Sub</span>
</span></span></code></pre></div><h2 class="mb-8 mt-8 pt-8 pl-4 group relative overflow-hidden after:content-[''] after:absolute after:top-8 after:left-0 after:bg-primary after:w-[2px] after:h-full" id=final-words>Final words
<a class="text-primary border-0 hidden group-hover:inline-block align-middle" style=--icon-size:24px href=#final-words><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link-2"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>You probably have a better way to do it, I would only recommend this approach to
someone in an environment very dependent on Excel, simply because it is super
convenient. You can put the report anywhere you want with zero overhead &ndash; no
need for a library to understand the complexity of an Excel archive.</p><p>And I gotta say, VBA is kind of a hard, its ecosystem is not great, obviously.
But I was very impressed by what it can do, despite of its shortcomings.
Nonetheless, it was still fun to write this.</p></section></article><hr class=my-8><div data-theme-copy-code-tooltip role=tooltip class="absolute pointer-events-none border border-divider bg-surface rounded-md px-2" style=opacity:0>Copied<div data-theme-copy-code-tooltip-arrow class="absolute bg-surface border-r border-b border-divider w-[8px] h-[8px] rotate-45"></div></div><nav class="flex justify-between flex-wrap sm:flex-nowrap gap-2" aria-label="Posts navigation"><a class="flex basis-1/2 grow items-center self-end text-right h-full justify-end gap-2 border-0" href=/posts/async-make-in-nvim-with-lua/>Asynchronous :make in Neovim with Lua
<span class=text-primary><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span></a></nav></main></div><footer class="mx-auto w-full max-w-5xl flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 px-default-padding py-8"><div class="flex flex-wrap justify-center sm:order-last sm:justify-end"><nav aria-label=Links><div class="flex gap-4"><a class="border-0
transform hover:scale-110 hover:text-primary transition transition-transform transition-colors" href=mailto:phelipe_teles@hotmail.com aria-label=E-mail><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a class="border-0
transform hover:scale-110 hover:text-primary transition transition-transform transition-colors" href=https://linkedin.com/in/phelipeteles aria-label=LinkedIn><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a class="border-0
transform hover:scale-110 hover:text-primary transition transition-transform transition-colors" href=https://github.com/phelipetls aria-label=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a class="border-0
transform hover:scale-110 hover:text-primary transition transition-transform transition-colors" href=https://phelipetls.github.io/posts/index.xml aria-label="Blog RSS Feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss inline"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></nav></div><p class=flex-1>This content is under a
<a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0</a>
license.</p></footer></div><script type=module src=https://phelipetls.github.io/js/bundle.min.js></script></body></html>