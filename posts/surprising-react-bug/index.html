<!DOCTYPE html>
<html class="h-full text-base sm:text-lg selection:bg-primary selection:text-on-primary scroll-smooth scroll-pt-nav-height sm:scroll-pt-0" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="deploy-date" content="2023-04-21">
    <meta name="author" content="Phelipe Teles">
    <meta name="color-scheme" content="dark light">

    <title>An apparent React bug - Phelipe Teles | Phelipe Teles</title>



<link rel="canonical" href="https://phelipetls.github.io/posts/surprising-react-bug/">

<meta name="description" content="The details HTML element doesn’t seem to work well when used as a controlled
component in React, as pointed out in this open GitHub
issue. At first, I thought it
was a React bug, but at the end of my investigation while writing this, I
concluded it’s simply a mistake — not having a single source of truth for
state.">

<meta name="robots" content="index, follow">

<meta property="og:title" content="An apparent React bug">
<meta property="og:type" content="article">
<meta property="og:image" content="/posts/surprising-react-bug/image.png">
<meta property="og:url" content="https://phelipetls.github.io/posts/surprising-react-bug/">


<meta property="article:published_time" content="2022-09-10T00:00:00Z">


<meta property="article:author" content="Phelipe Teles">

<meta property="article:tag" content="react"><meta property="article:tag" content="javascript"><meta property="article:tag" content="html">
<meta name="twitter:card" content="summary_large_image">



<meta content="/posts/surprising-react-bug/image.png" name="twitter:image">

    

    
    <meta name="publish-date" content="2022-09-10">
    <meta name="keywords" content="react, javascript, html"><meta name="description" content="The details HTML element doesn’t seem to work well when used as a controlled
component in React, as pointed out in this open GitHub
issue. At first, I thought it
was a React bug, but at the end of my investigation while writing this, I
concluded it’s simply a mistake — not having a single source of truth for
state.">

    <style id="sandpack">--sxs{--sxs:0 light sp-482805736}@media{.light{--sp-space-1:4px;--sp-space-2:8px;--sp-space-3:12px;--sp-space-4:16px;--sp-space-5:20px;--sp-space-6:24px;--sp-space-7:28px;--sp-space-8:32px;--sp-space-9:36px;--sp-space-10:40px;--sp-space-11:44px;--sp-border-radius:4px;--sp-layout-height:300px;--sp-layout-headerHeight:40px;--sp-transitions-default:150ms ease;--sp-zIndices-base:1;--sp-zIndices-overlay:2;--sp-zIndices-top:3;--sp-colors-surface1:#ffffff;--sp-colors-surface2:#EFEFEF;--sp-colors-surface3:#F3F3F3;--sp-colors-disabled:#C5C5C5;--sp-colors-base:#323232;--sp-colors-clickable:#808080;--sp-colors-hover:#4D4D4D;--sp-colors-accent:#3973E0;--sp-colors-error:#EA3323;--sp-colors-errorSurface:#FCF1F0;--sp-colors-warning:#6A4516;--sp-colors-warningSurface:#FEF2C0;--sp-font-body:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--sp-font-mono:"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace;--sp-font-size:13px;--sp-font-lineHeight:20px;--sp-syntax-color-plain:#151515;--sp-syntax-color-comment:#999;--sp-syntax-fontStyle-comment:italic;--sp-syntax-color-keyword:#7C5AE3;--sp-syntax-color-tag:#0971F1;--sp-syntax-color-punctuation:#3B3B3B;--sp-syntax-color-definition:#85A600;--sp-syntax-color-property:#3B3B3B;--sp-syntax-color-static:#3B3B3B;--sp-syntax-color-string:#2E6BD0}.sp-482805736{--sp-space-1:4px;--sp-space-2:8px;--sp-space-3:12px;--sp-space-4:16px;--sp-space-5:20px;--sp-space-6:24px;--sp-space-7:28px;--sp-space-8:32px;--sp-space-9:36px;--sp-space-10:40px;--sp-space-11:44px;--sp-border-radius:4px;--sp-layout-height:300px;--sp-layout-headerHeight:40px;--sp-transitions-default:150ms ease;--sp-zIndices-base:1;--sp-zIndices-overlay:2;--sp-zIndices-top:3;--sp-colors-surface1:#282c34;--sp-colors-surface2:#21252b;--sp-colors-surface3:#2c313c;--sp-colors-disabled:#4d4d4d;--sp-colors-base:#a8b1c2;--sp-colors-clickable:#a8b1c2;--sp-colors-hover:#e8effc;--sp-colors-accent:#c678dd;--sp-colors-error:#e06c75;--sp-colors-errorSurface:#ffeceb;--sp-colors-warning:#E7C400;--sp-colors-warningSurface:#3A3000;--sp-font-body:"Fira Sans", sans-serif;--sp-font-mono:Consolas, Menlo, Monaco, "Fira Code", monospace;--sp-font-size:1rem;--sp-font-lineHeight:1.5;--sp-syntax-color-plain:#a8b1c2;--sp-syntax-color-comment:#757575;--sp-syntax-fontStyle-comment:italic;--sp-syntax-color-keyword:#c678dd;--sp-syntax-color-tag:#e06c75;--sp-syntax-color-punctuation:#a8b1c2;--sp-syntax-color-definition:#62aeef;--sp-syntax-color-property:#d19a66;--sp-syntax-color-static:#a8b1c2;--sp-syntax-color-string:#98c379}}--sxs{--sxs:1 sp-k-eyOShd sp-k-iOHdLQ}@media{@keyframes sp-k-eyOShd{0%{opacity:0}100%{opacity:1}}@keyframes sp-k-iOHdLQ{0%{transform:rotateX(-25.5deg) rotateY(45deg)}100%{transform:rotateX(-25.5deg) rotateY(405deg)}}}--sxs{--sxs:2 sp-c-gMfcns sp-c-bxeRRt sp-c-hfoyCM sp-c-fWymNx sp-c-euXojQ sp-c-bpmgvy sp-c-PJLV sp-c-fVPbOs sp-c-gtcpyq sp-c-jOWzsE sp-c-jkvvao sp-c-juMdfR sp-c-fgviib sp-c-kwibBT}@media{.sp-c-gMfcns svg{margin:auto}.sp-c-bxeRRt{-webkit-appearance:none;appearance:none;outline:none;display:flex;align-items:center;font-size:inherit;font-family:inherit;background-color:transparent;transition:color var(--sp-transitions-default), background var(--sp-transitions-default);cursor:pointer;color:var(--sp-colors-clickable);border:0;text-decoration:none}.sp-c-bxeRRt:disabled{color:var(--sp-colors-disabled)}.sp-c-bxeRRt:hover:not(:disabled,[data-active='true']){color:var(--sp-colors-hover)}.sp-c-bxeRRt[data-active="true"]{color:var(--sp-colors-accent)}.sp-c-bxeRRt svg{min-width:var(--sp-space-4);width:var(--sp-space-4);height:var(--sp-space-4)}.sp-c-bxeRRt.sp-c-gMfcns{padding:var(--sp-space-1);height:var(--sp-space-7);display:flex}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:not(:has(span)){width:var(--sp-space-7)}.sp-c-bxeRRt.sp-c-gMfcns.sp-c-bxeRRt:has(svg + span){padding-right:var(--sp-space-3);padding-left:var(--sp-space-2);gap:var(--sp-space-1)}.sp-c-hfoyCM{padding:0 var(--sp-space-1) 0 var(--sp-space-1);border-radius:var(--sp-border-radius);margin-left:var(--sp-space-1);width:var(--sp-space-5);visibility:hidden}.sp-c-hfoyCM svg{width:var(--sp-space-3);height:var(--sp-space-3);display:block;position:relative;top:1px}.sp-c-fWymNx{margin:0;display:block;font-family:var(--sp-font-mono);font-size:var(--sp-font-size);color:var(--sp-syntax-color-plain);line-height:var(--sp-font-lineHeight)}.sp-c-euXojQ{display:flex;flex-direction:column;width:100%;position:relative;background-color:var(--sp-colors-surface1);gap:1px}.sp-c-euXojQ:has(.sp-stack){background-color:var(--sp-colors-surface2)}.sp-c-bpmgvy{transform:translate(-4px, 9px) scale(0.13, 0.13)}.sp-c-bpmgvy *{position:absolute;width:96px;height:96px}.sp-c-fVPbOs{all:initial;font-size:var(--sp-font-size);font-family:var(--sp-font-body);display:block;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:subpixel-antialiased}@media screen and (min-resolution: 2dppx){.sp-c-fVPbOs{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}}.sp-c-fVPbOs *{box-sizing:border-box}.sp-c-fVPbOs .sp-wrapper:focus{outline:0}.sp-c-gtcpyq{flex:1;position:relative;overflow:auto;background:var(--sp-colors-surface1)}.sp-c-gtcpyq .cm-scroller{padding:var(--sp-space-4) 0}.sp-c-gtcpyq .sp-c-fWymNx{padding:var(--sp-space-4) 0}@media screen and (max-width: 768px){@supports (-webkit-overflow-scrolling: touch){.sp-c-gtcpyq .cm-content{font-size:16px}}}.sp-c-jOWzsE{margin:0;outline:none;height:100%}.sp-c-jkvvao .sp-syntax-string{color:var(--sp-syntax-color-string);font-style:var(--sp-syntax-fontStyle-string)}.sp-c-jkvvao .sp-syntax-plain{color:var(--sp-syntax-color-plain);font-style:var(--sp-syntax-fontStyle-plain)}.sp-c-jkvvao .sp-syntax-comment{color:var(--sp-syntax-color-comment);font-style:var(--sp-syntax-fontStyle-comment)}.sp-c-jkvvao .sp-syntax-keyword{color:var(--sp-syntax-color-keyword);font-style:var(--sp-syntax-fontStyle-keyword)}.sp-c-jkvvao .sp-syntax-definition{color:var(--sp-syntax-color-definition);font-style:var(--sp-syntax-fontStyle-definition)}.sp-c-jkvvao .sp-syntax-punctuation{color:var(--sp-syntax-color-punctuation);font-style:var(--sp-syntax-fontStyle-punctuation)}.sp-c-jkvvao .sp-syntax-property{color:var(--sp-syntax-color-property);font-style:var(--sp-syntax-fontStyle-property)}.sp-c-jkvvao .sp-syntax-tag{color:var(--sp-syntax-color-tag);font-style:var(--sp-syntax-fontStyle-tag)}.sp-c-jkvvao .sp-syntax-static{color:var(--sp-syntax-color-static);font-style:var(--sp-syntax-fontStyle-static)}.sp-c-juMdfR{flex:1;display:flex;flex-direction:column;background:white;overflow:auto;position:relative}.sp-c-juMdfR .sp-bridge-frame{border:0;position:absolute;left:var(--sp-space-2);bottom:var(--sp-space-2);z-index:var(--sp-zIndices-top);height:12px;width:30%;mix-blend-mode:multiply;pointer-events:none}.sp-c-fgviib{border:0;outline:0;width:100%;height:100%;min-height:160px;max-height:2000px;flex:1}.sp-c-kwibBT{display:flex;position:absolute;bottom:var(--sp-space-2);right:var(--sp-space-2);z-index:var(--sp-zIndices-overlay);gap:var(--sp-space-2)}}--sxs{--sxs:3 sp-c-PJLV-kCOVwI-status-pass sp-c-PJLV-kEzYsr-status-fail sp-c-PJLV-gHAhSA-status-skip sp-c-PJLV-jgnHyR-status-title sp-c-PJLV-iCgxLS-status-run sp-c-PJLV-bnDZSy-status-pass sp-c-PJLV-eYuGwt-status-fail sp-c-fVPbOs-gMQIch-variant-light sp-c-fVPbOs-LrWkf-variant-dark}@media{.sp-c-PJLV-kCOVwI-status-pass{color:var(--test-pass)}.sp-c-PJLV-kEzYsr-status-fail{color:var(--test-fail)}.sp-c-PJLV-gHAhSA-status-skip{color:var(--test-skip)}.sp-c-PJLV-jgnHyR-status-title{color:var(--test-title)}.sp-c-PJLV-iCgxLS-status-run{background:var(--test-run);color:var(--sp-colors-surface1)}.sp-c-PJLV-bnDZSy-status-pass{background:var(--test-pass);color:var(--sp-colors-surface1)}.sp-c-PJLV-eYuGwt-status-fail{background:var(--test-fail);color:var(--sp-colors-surface1)}.sp-c-fVPbOs-gMQIch-variant-light{color-scheme:light}.sp-c-fVPbOs-LrWkf-variant-dark{color-scheme:dark}}</style>
  
  <link rel="stylesheet" href="/_astro/_id_.6b92d84b.css" />
<link rel="stylesheet" href="/_astro/_id_.aac35682.css" /><script type="module" src="/_astro/hoisted.ba9a293e.js"></script></head>

  <body data-preload class="relative flex h-full flex-col bg-background font-sans text-on-background">
    <script>
  // @ts-check
  const storedThemeChoice = window.localStorage.getItem('__theme') ?? 'system'

  window.__setTheme = setTheme
  // prettier-ignore
  window.__setTheme(/** @type {ThemeChoice} */ (storedThemeChoice))

  /**
   * @type {(themeChoice: ThemeChoice) => void}
   */
  function setTheme(themeChoice) {
    let theme = themeChoice

    if (themeChoice === 'system') {
      theme = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light'
    }

    document.body.classList.toggle('dark', theme === 'dark')

    window.localStorage.setItem('__theme', themeChoice)

    document.body.dispatchEvent(
      new CustomEvent('newTheme', {
        detail: {
          themeChoice,
          theme,
        },
      })
    )
  }

  window.addEventListener('storage', function (e) {
    const newTheme = e.newValue
    if (newTheme && newTheme && e.key === '__theme') {
      // prettier-ignore
      window.__setTheme(/** @type {ThemeChoice} */ (newTheme))
    }
  })

  window.addEventListener('load', function () {
    document.body.removeAttribute('data-preload')
  })
</script>

    <div class="w-full">
  <div class="pt-nav-height sm:hidden">
    <div class="fixed top-0 left-0 z-30 flex w-screen justify-between rounded-none border-b border-divider bg-background/90 py-4 px-horizontal-padding backdrop-blur">
  <div class="flex flex-row items-center gap-2 overflow-hidden">
    <a class="border-0" href="/posts/" data-testid="parent-page-link" aria-label="Go back to previous page">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg>
        </a>

    <h2 class="m-0 truncate font-sans font-normal">An apparent React bug - Phelipe Teles</h2>
  </div>

  <button data-a11y-dialog-show="sidenav" class="btn btn-icon" data-testid="open-sidenav" aria-label="Open navigation sidebar">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="6" x2="20" y2="6"></line><line x1="4" y1="18" x2="20" y2="18"></line></svg>
  </button>
</div>
  </div>

  <div class="hidden h-full w-full sm:block">
    <div class="flex h-full w-full items-center justify-between bg-background pr-horizontal-padding">
  <div class="mx-auto flex h-full w-full max-w-content justify-between">
    <nav class="flex h-full justify-between overflow-x-auto px-horizontal-padding" aria-label="Main navigation">
      <ul class="m-0 flex list-none flex-row flex-nowrap items-center gap-2">
        <li>
                <a id="about" href="/" class="hover:bg-hover relative flex items-center justify-center rounded border-0 py-1 px-2 transition-colors duration-300">
                  About
                </a>
              </li><li>
                <a id="posts" href="/posts" class="bg-primary text-on-primary card hover:bg-primary-hover relative flex items-center justify-center rounded border-0 py-1 px-2 transition-colors duration-300" aria-current="page">
                  Posts
                </a>
              </li><li>
                <a id="resume" href="/resume" class="hover:bg-hover relative flex items-center justify-center rounded border-0 py-1 px-2 transition-colors duration-300">
                  Résumé
                </a>
              </li>
      </ul>
    </nav>

    <div class="h-full py-3">
      <div class="flex h-full flex-row items-stretch gap-2 pl-2">
        <div class="relative flex h-full flex-row items-center">
  <span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm">
    <svg class="feather" viewBox="0 0 24 24" width="24" height="24">
      <title>Theme icon</title>

      <defs>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon" id="moon"><path d="M12 3a6.364 6.364 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun" id="sun"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor" id="monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
      </defs>

      <use data-theme-select-icon href="#monitor"></use>
    </svg>
  </span>

  <select class="card h-full appearance-none bg-surface py-1 px-10 text-center" data-theme-select aria-label="Choose a theme">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="system">System</option>
  </select>

  <span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </span>
</div>
      </div>
    </div>
  </div>
</div>
  </div>
</div>
    <aside data-a11y-dialog="sidenav" aria-hidden="true" class="fixed z-50 h-full w-full" style="visibility: hidden;">
  <div data-a11y-dialog-hide class="fixed inset-0 -z-1 w-full bg-neutral-700 bg-opacity-75 backdrop-blur-sm">
  </div>

  <div role="document" class="ml-auto h-full w-3/4 rounded-none bg-background py-0 will-change-transform">
    <div class="flex h-full flex-col justify-between">
      <div class="mb-2 flex h-nav-height items-center justify-end px-horizontal-padding">
        <button data-a11y-dialog-hide class="btn btn-icon" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>

      <nav class="flex flex-1 flex-col" aria-label="Main navigation">
        <ul class="m-0 flex list-none flex-col items-center justify-center gap-4 px-horizontal-padding">
          <li class="w-full">
                  <a id="about" href="/" class="hover:bg-hover block w-full rounded border-0 p-2 text-center text-xl transition-colors duration-300">
                    About
                  </a>
                </li><li class="w-full">
                  <a id="posts" href="/posts" class="card bg-primary text-on-primary hover:bg-primary-hover block w-full rounded border-0 p-2 text-center text-xl transition-colors duration-300" aria-current="page">
                    Posts
                  </a>
                </li><li class="w-full">
                  <a id="resume" href="/resume" class="hover:bg-hover block w-full rounded border-0 p-2 text-center text-xl transition-colors duration-300">
                    Résumé
                  </a>
                </li>
        </ul>
      </nav>

      <div class="mb-4 flex h-12 flex-row items-center justify-center px-horizontal-padding">
        <div class="relative flex h-full flex-row items-center">
  <span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm">
    <svg class="feather" viewBox="0 0 24 24" width="24" height="24">
      <title>Theme icon</title>

      <defs>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon" id="moon"><path d="M12 3a6.364 6.364 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun" id="sun"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor" id="monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
      </defs>

      <use data-theme-select-icon href="#monitor"></use>
    </svg>
  </span>

  <select class="card h-full appearance-none bg-surface py-1 px-10 text-center" data-theme-select aria-label="Choose a theme">
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="system">System</option>
  </select>

  <span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </span>
</div>
      </div>
    </div>
  </div>
</aside>

    
  

  <main class="grid grid-cols-layout">
    <div class="col-full max-w-full rounded-none px-horizontal-padding pt-8 shadow-none sm:col-content sm:px-0">
      <article>
        <header>
          <h1 class="mb-4 text-4xl">
            An apparent React bug
          </h1>

          <div class="mb-4 flex flex-col gap-2">
            <div class="flex items-center gap-2">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>

  <div>3 min.</div>
</div>

            <div class="flex items-center gap-2">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>

  <time datetime="2022-09-10">
    September 10, 2022
  </time>
</div>
          </div>

          <div class="mb-4 flex flex-wrap gap-2">
                <a class="inline-flex gap-2 w-fit items-center justify-center rounded-full border border-divider bg-surface px-4 no-underline shadow shadow-shadow transition-colors duration-300 hover:border-divider hover:bg-hover whitespace-nowrap [&#38;_svg]:w-[1em] [&#38;_svg]:h-[1em]" href="/tags/react">
  <svg viewBox="0 0 128 128" width="1em" height="1em"><g fill="currentColor"><circle cx="64" cy="64" r="11.4"></circle><path d="M107.3 45.2c-2.2-.8-4.5-1.6-6.9-2.3.6-2.4 1.1-4.8 1.5-7.1 2.1-13.2-.2-22.5-6.6-26.1-1.9-1.1-4-1.6-6.4-1.6-7 0-15.9 5.2-24.9 13.9-9-8.7-17.9-13.9-24.9-13.9-2.4 0-4.5.5-6.4 1.6-6.4 3.7-8.7 13-6.6 26.1.4 2.3.9 4.7 1.5 7.1-2.4.7-4.7 1.4-6.9 2.3C8.2 50 1.4 56.6 1.4 64s6.9 14 19.3 18.8c2.2.8 4.5 1.6 6.9 2.3-.6 2.4-1.1 4.8-1.5 7.1-2.1 13.2.2 22.5 6.6 26.1 1.9 1.1 4 1.6 6.4 1.6 7.1 0 16-5.2 24.9-13.9 9 8.7 17.9 13.9 24.9 13.9 2.4 0 4.5-.5 6.4-1.6 6.4-3.7 8.7-13 6.6-26.1-.4-2.3-.9-4.7-1.5-7.1 2.4-.7 4.7-1.4 6.9-2.3 12.5-4.8 19.3-11.4 19.3-18.8s-6.8-14-19.3-18.8zM92.5 14.7c4.1 2.4 5.5 9.8 3.8 20.3-.3 2.1-.8 4.3-1.4 6.6-5.2-1.2-10.7-2-16.5-2.5-3.4-4.8-6.9-9.1-10.4-13 7.4-7.3 14.9-12.3 21-12.3 1.3 0 2.5.3 3.5.9zM81.3 74c-1.8 3.2-3.9 6.4-6.1 9.6-3.7.3-7.4.4-11.2.4-3.9 0-7.6-.1-11.2-.4-2.2-3.2-4.2-6.4-6-9.6-1.9-3.3-3.7-6.7-5.3-10 1.6-3.3 3.4-6.7 5.3-10 1.8-3.2 3.9-6.4 6.1-9.6 3.7-.3 7.4-.4 11.2-.4 3.9 0 7.6.1 11.2.4 2.2 3.2 4.2 6.4 6 9.6 1.9 3.3 3.7 6.7 5.3 10-1.7 3.3-3.4 6.6-5.3 10zm8.3-3.3c1.5 3.5 2.7 6.9 3.8 10.3-3.4.8-7 1.4-10.8 1.9 1.2-1.9 2.5-3.9 3.6-6 1.2-2.1 2.3-4.2 3.4-6.2zM64 97.8c-2.4-2.6-4.7-5.4-6.9-8.3 2.3.1 4.6.2 6.9.2 2.3 0 4.6-.1 6.9-.2-2.2 2.9-4.5 5.7-6.9 8.3zm-18.6-15c-3.8-.5-7.4-1.1-10.8-1.9 1.1-3.3 2.3-6.8 3.8-10.3 1.1 2 2.2 4.1 3.4 6.1 1.2 2.2 2.4 4.1 3.6 6.1zm-7-25.5c-1.5-3.5-2.7-6.9-3.8-10.3 3.4-.8 7-1.4 10.8-1.9-1.2 1.9-2.5 3.9-3.6 6-1.2 2.1-2.3 4.2-3.4 6.2zM64 30.2c2.4 2.6 4.7 5.4 6.9 8.3-2.3-.1-4.6-.2-6.9-.2-2.3 0-4.6.1-6.9.2 2.2-2.9 4.5-5.7 6.9-8.3zm22.2 21-3.6-6c3.8.5 7.4 1.1 10.8 1.9-1.1 3.3-2.3 6.8-3.8 10.3-1.1-2.1-2.2-4.2-3.4-6.2zM31.7 35c-1.7-10.5-.3-17.9 3.8-20.3 1-.6 2.2-.9 3.5-.9 6 0 13.5 4.9 21 12.3-3.5 3.8-7 8.2-10.4 13-5.8.5-11.3 1.4-16.5 2.5-.6-2.3-1-4.5-1.4-6.6zM7 64c0-4.7 5.7-9.7 15.7-13.4 2-.8 4.2-1.5 6.4-2.1 1.6 5 3.6 10.3 6 15.6-2.4 5.3-4.5 10.5-6 15.5C15.3 75.6 7 69.6 7 64zm28.5 49.3c-4.1-2.4-5.5-9.8-3.8-20.3.3-2.1.8-4.3 1.4-6.6 5.2 1.2 10.7 2 16.5 2.5 3.4 4.8 6.9 9.1 10.4 13-7.4 7.3-14.9 12.3-21 12.3-1.3 0-2.5-.3-3.5-.9zM96.3 93c1.7 10.5.3 17.9-3.8 20.3-1 .6-2.2.9-3.5.9-6 0-13.5-4.9-21-12.3 3.5-3.8 7-8.2 10.4-13 5.8-.5 11.3-1.4 16.5-2.5.6 2.3 1 4.5 1.4 6.6zm9-15.6c-2 .8-4.2 1.5-6.4 2.1-1.6-5-3.6-10.3-6-15.6 2.4-5.3 4.5-10.5 6-15.5 13.8 4 22.1 10 22.1 15.6 0 4.7-5.8 9.7-15.7 13.4z"></path></g></svg>

  react

  
</a><a class="inline-flex gap-2 w-fit items-center justify-center rounded-full border border-divider bg-surface px-4 no-underline shadow shadow-shadow transition-colors duration-300 hover:border-divider hover:bg-hover whitespace-nowrap [&#38;_svg]:w-[1em] [&#38;_svg]:h-[1em]" href="/tags/javascript">
  <svg viewBox="0 0 128 128" width="1em" height="1em"><path fill="currentColor" d="M2 1v125h125V1H2zm66.119 106.513c-1.845 3.749-5.367 6.212-9.448 7.401-6.271 1.44-12.269.619-16.731-2.059-2.986-1.832-5.318-4.652-6.901-7.901l9.52-5.83c.083.035.333.487.667 1.071 1.214 2.034 2.261 3.474 4.319 4.485 2.022.69 6.461 1.131 8.175-2.427 1.047-1.81.714-7.628.714-14.065C58.433 78.073 58.48 68 58.48 58h11.709c0 11 .06 21.418 0 32.152.025 6.58.596 12.446-2.07 17.361zm48.574-3.308c-4.07 13.922-26.762 14.374-35.83 5.176-1.916-2.165-3.117-3.296-4.26-5.795 4.819-2.772 4.819-2.772 9.508-5.485 2.547 3.915 4.902 6.068 9.139 6.949 5.748.702 11.531-1.273 10.234-7.378-1.333-4.986-11.77-6.199-18.873-11.531-7.211-4.843-8.901-16.611-2.975-23.335 1.975-2.487 5.343-4.343 8.877-5.235l3.688-.477c7.081-.143 11.507 1.727 14.756 5.355.904.916 1.642 1.904 3.022 4.045-3.772 2.404-3.76 2.381-9.163 5.879-1.154-2.486-3.069-4.046-5.093-4.724-3.142-.952-7.104.083-7.926 3.403-.285 1.023-.226 1.975.227 3.665 1.273 2.903 5.545 4.165 9.377 5.926 11.031 4.474 14.756 9.271 15.672 14.981.882 4.916-.213 8.105-.38 8.581z"></path></svg>

  javascript

  
</a><a class="inline-flex gap-2 w-fit items-center justify-center rounded-full border border-divider bg-surface px-4 no-underline shadow shadow-shadow transition-colors duration-300 hover:border-divider hover:bg-hover whitespace-nowrap [&#38;_svg]:w-[1em] [&#38;_svg]:h-[1em]" href="/tags/html">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag"><path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"></path><path d="M7 7h.01"></path></svg>

  html

  
</a>

                <a class="inline-flex gap-2 w-fit items-center justify-center rounded-full border border-divider bg-surface px-4 no-underline shadow shadow-shadow transition-colors duration-300 hover:border-divider hover:bg-hover whitespace-nowrap [&#38;_svg]:w-[1em] [&#38;_svg]:h-[1em]" href="/tags">
  

  ...

  
</a>
              </div>
        </header>

        <hr class="my-8">

        <div class="flex flex-col-reverse lg:grid lg:grid-cols-[minmax(65ch,1fr),1fr] lg:gap-8">
          <div data-blog-post class="[&#38;>pre]:full-width-on-mobile [&#38;>figure]:full-width-on-mobile [&#38;>[data-codeblock]]:full-width-on-mobile [&#38;>[data-codeblock]_pre]:max-sm:rounded-none [&#38;>[data-codeblock-with-header]]:mt-16 [&#38;_img]:mx-auto [&#38;>hr]:border-0 [&#38;>hr]:text-center [&#38;>hr]:after:content-['⁂'] [&#38;>pre]:my-8 [&#38;>figure]:my-8 [&#38;>img]:my-8 [&#38;>astro-island>div]:my-8 [&#38;>lite-youtube]:my-8 [&#38;>blockquote]:my-8 [&#38;>figure_video]:min-h-[15em] [&#38;_.katex-display]:overflow-x-auto [&#38;_.katex-display]:overflow-y-hidden [&#38;_*:where(h2,h3,h4,h5,h6)]:mb-8 [&#38;_*:where(h2,h3,h4,h5,h6)]:mt-4 [&#38;_*:where(h2,h3,h4,h5,h6)]:pt-4 [&#38;_*:where(h2,h3,h4,h5,h6)_a]:text-primary [&#38;_*:where(h2,h3,h4,h5,h6)_a]:border-0 [&#38;_*:where(h2,h3,h4,h5,h6)_a]:before:content-[&#34;_#&#34;]">
            
  <p>The <code>details</code> HTML element doesn’t seem to work well when used as a controlled
component in React, as pointed out in <a href="https://github.com/facebook/react/issues/15486">this open GitHub
issue</a>. At first, I thought it
was a React bug, but at the end of my investigation while writing this, I
concluded it’s simply a mistake — not having a single source of truth for
state.</p>
<p>Let’s begin by understanding the “bug” itself. Here it is:</p>
<style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).visible=(s,c,n)=>{const r=async()=>{await(await s())()};let i=new IntersectionObserver(e=>{for(const t of e)if(t.isIntersecting){i.disconnect(),r();break}});for(let e=0;e<n.children.length;e++){const t=n.children[e];i.observe(t)}},window.dispatchEvent(new Event("astro:visible"));var l;{const c={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(JSON.parse(t)),9:t=>new Uint16Array(JSON.parse(t)),10:t=>new Uint32Array(JSON.parse(t))},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,n]=s;return e in c?c[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(l=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement&&this.parentElement.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(const r of n){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(const r of s){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML)}const a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((s,e)=>{e.disconnect(),this.childrenConnectedCallback()}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate);let s=this.getAttribute("before-hydration-url");s&&await import(s),this.start()}start(){const s=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{const n=this.getAttribute("renderer-url"),[a,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(const d of i.split("."))this.Component=this.Component[d]}return this.hydrator=r,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},l.observedAttributes=["props"],l))}</script><astro-island uid="gcxfH" component-url="/_astro/_BugReactSandpack.9917cad2.js" component-export="default" renderer-url="/_astro/client.47a71f61.js" props="{}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;_function$4&quot;,&quot;value&quot;:true}" await-children=""><div class="light sp-c-fVPbOs sp-c-fVPbOs-gMQIch-variant-light sp-wrapper"><div class="sp-482805736 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="my-8"><div role="tablist" class="space-x-2" style="--sandpack-surface1:#282c34;--sandpack-surface3:#2c313c;--sandpack-accent:#c678dd;--sandpack-base:#a8b1c2"><button type="button" role="tab" aria-selected="true" class="rounded-t p-2 transition-colors duration-300 border-primary [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">App.js</button></div><div class="full-width-on-mobile shadow shadow-shadow sm:rounded-b"><div class="dark group relative [&amp;_.sp-code-editor_*]:sm:rounded [&amp;_.sp-code-editor_*]:sm:rounded-tl-none"><div class="sp-c-euXojQ sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">App</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setIsOpen</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-static">false</span><span class="sp-syntax-punctuation">)</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>State: <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span> ? <span class="sp-syntax-string">&#x27;open&#x27;</span> : <span class="sp-syntax-string">&#x27;closed&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>

      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">details</span> <span class="sp-syntax-property">open</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">summary</span>
          <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
            <span class="sp-syntax-definition">setIsOpen</span><span class="sp-syntax-punctuation">(</span>!<span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">)</span>
          <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-punctuation">&gt;</span>
          Summary
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>
        Details
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">details</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span>
<span class="sp-syntax-punctuation">}</span></pre></div></div></div><button type="button" class="flex items-center justify-center flex-row gap-2 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow absolute right-0 top-3 -translate-x-1/2 transition-opacity duration-500 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto focus:opacity-100 focus:pointer-events-auto"><span class="text-[var(--code-fg)]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></span></button></div><hr/><div class="relative [&amp;_.sp-preview-container]:sm:rounded-b [&amp;_.sp-preview-container]:px-horizontal-padding [&amp;_.sp-preview-container]:pt-3 [&amp;_.sp-stack]:bg-transparent"><noscript><div class="px-horizontal-padding pt-3 text-on-background">You need to enable JavaScript to preview the code.</div></noscript><div class="sp-c-euXojQ sp-preview sp-stack" title="Bug when using details element with React"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"></div></div></div><div class="absolute right-horizontal-padding top-3 flex space-x-2"><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Open on Codesandbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-codesandbox"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></button><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg></button></div></div></div></div></div></div></astro-island>
<p>Here’s a video showing it next to an HTML inspector:</p>
<figure>
  
  <video class="mx-auto" controls src="/_astro/_bug.5e0b75e3.webm"></video>

  <figcaption class="mt-2 px-horizontal-padding text-center">
        The details HTML element open attribute is not synchronized with React&#39;s state
      </figcaption>
</figure>
<p>The <code>isOpen</code> state changes as expected, but the <code>&lt;details&gt;</code> element’s <code>open</code>
attribute is not synchronized with it — or rather, it’s in a negative way, as
if we’re passing <code>open={!isOpen}</code>.</p>
<h2 id="why">Why?<a aria-hidden="true" tabindex="-1" href="#why"><span class="icon icon-link"></span></a></h2>
<p>It seems React is “doing the right thing”, but in the end things break because
the <code>details</code> element has state of its own that React doesn’t know about.</p>
<p>In short, the issue is that there are two sources of truth for the <code>open</code>
attribute — React and the browser.</p>
<p><a href="https://github.com/facebook/react/issues/15486#issuecomment-873516817">This was masterfully explained in this GitHub
comment</a>.
It begins by explaining what happens when we click the button the first time:</p>
<ol>
<li>The <code>onClick</code> event handler of the <code>summary</code> element is triggered, which
changes <code>isOpen</code> from <code>false</code> to <code>true</code>.</li>
<li>React re-renders, setting the <code>open</code> attribute of the <code>details</code> element to
<code>true</code>.</li>
<li>The default behavior of the <code>details</code> element toggles its <code>open</code> state,
reversing it back to <code>false</code> — but React doesn’t know about it.</li>
</ol>
<p>So that’s how the <code>details</code> element ends up without an <code>open</code> attribute
(equivalent to <code>isOpen={false}</code>) while our <code>isOpen</code> state is <code>true</code> — the
browser removed it and React doesn’t know about it.</p>
<p>On the second click:</p>
<ol>
<li>The <code>onClick</code> handler of the <code>summary</code> element is triggered, which toggles
<code>isOpen</code> to <code>false</code>.</li>
<li>React re-renders, and finds <code>details</code> already closed, so it doesn’t change
it.</li>
<li>The default behavior of the <code>details</code> element toggles its <code>open</code> state again
— it was <code>false</code> (closed) so it changes it to <code>true</code> (open), and React has
no clue.</li>
</ol>
<p>Everything is broken.</p>
<h2 id="workarounds">Workarounds<a aria-hidden="true" tabindex="-1" href="#workarounds"><span class="icon icon-link"></span></a></h2>
<h2 id="epreventdefault"><code>e.preventDefault()</code><a aria-hidden="true" tabindex="-1" href="#epreventdefault"><span class="icon icon-link"></span></a></h2>
<p>The fix is to call <code>preventDefault</code> on the <code>onClick</code> event handler of the
<code>summary</code> element:</p>
<astro-island uid="Z17MkE4" component-url="/_astro/_FixWithPreventDefaultSandpack.415f9594.js" component-export="default" renderer-url="/_astro/client.47a71f61.js" props="{}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;_function$2&quot;,&quot;value&quot;:true}" await-children=""><div class="light sp-c-fVPbOs sp-c-fVPbOs-gMQIch-variant-light sp-wrapper"><div class="sp-482805736 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="my-8"><div role="tablist" class="space-x-2" style="--sandpack-surface1:#282c34;--sandpack-surface3:#2c313c;--sandpack-accent:#c678dd;--sandpack-base:#a8b1c2"><button type="button" role="tab" aria-selected="true" class="rounded-t p-2 transition-colors duration-300 border-primary [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">App.js</button></div><div class="full-width-on-mobile shadow shadow-shadow sm:rounded-b"><div class="dark group relative [&amp;_.sp-code-editor_*]:sm:rounded [&amp;_.sp-code-editor_*]:sm:rounded-tl-none"><div class="sp-c-euXojQ sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">App</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setIsOpen</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-static">false</span><span class="sp-syntax-punctuation">)</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>State: <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span> ? <span class="sp-syntax-string">&#x27;open&#x27;</span> : <span class="sp-syntax-string">&#x27;closed&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>

      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">details</span> <span class="sp-syntax-property">open</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">summary</span>
          <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
            <span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">preventDefault</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span>
            <span class="sp-syntax-definition">setIsOpen</span><span class="sp-syntax-punctuation">(</span>!<span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">)</span>
          <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-punctuation">&gt;</span>
          Summary
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>
        Details
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">details</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span>
<span class="sp-syntax-punctuation">}</span></pre></div></div></div><button type="button" class="flex items-center justify-center flex-row gap-2 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow absolute right-0 top-3 -translate-x-1/2 transition-opacity duration-500 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto focus:opacity-100 focus:pointer-events-auto"><span class="text-[var(--code-fg)]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></span></button></div><hr/><div class="relative [&amp;_.sp-preview-container]:sm:rounded-b [&amp;_.sp-preview-container]:px-horizontal-padding [&amp;_.sp-preview-container]:pt-3 [&amp;_.sp-stack]:bg-transparent"><noscript><div class="px-horizontal-padding pt-3 text-on-background">You need to enable JavaScript to preview the code.</div></noscript><div class="sp-c-euXojQ sp-preview sp-stack" title="Fixed bug when using details element with React, using preventDefault"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"></div></div></div><div class="absolute right-horizontal-padding top-3 flex space-x-2"><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Open on Codesandbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-codesandbox"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></button><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg></button></div></div></div></div></div></div></astro-island>
<p>This fixes it because now only React controls the <code>open</code> attribute.</p>
<h2 id="toggle-event"><code>toggle</code> event<a aria-hidden="true" tabindex="-1" href="#toggle-event"><span class="icon icon-link"></span></a></h2>
<p>Another way is to listen to the <code>toggle</code> event handler, which I learned about
thanks to this bug:</p>
<astro-island uid="ZSfhiF" component-url="/_astro/_FixWithToggleSandpack.ad8cfb96.js" component-export="default" renderer-url="/_astro/client.47a71f61.js" props="{}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;_function$1&quot;,&quot;value&quot;:true}" await-children=""><div class="light sp-c-fVPbOs sp-c-fVPbOs-gMQIch-variant-light sp-wrapper"><div class="sp-482805736 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="my-8"><div role="tablist" class="space-x-2" style="--sandpack-surface1:#282c34;--sandpack-surface3:#2c313c;--sandpack-accent:#c678dd;--sandpack-base:#a8b1c2"><button type="button" role="tab" aria-selected="true" class="rounded-t p-2 transition-colors duration-300 border-primary [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">App.js</button></div><div class="full-width-on-mobile shadow shadow-shadow sm:rounded-b"><div class="dark group relative [&amp;_.sp-code-editor_*]:sm:rounded [&amp;_.sp-code-editor_*]:sm:rounded-tl-none"><div class="sp-c-euXojQ sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">App</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setIsOpen</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-static">false</span><span class="sp-syntax-punctuation">)</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>State: <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span> ? <span class="sp-syntax-string">&#x27;open&#x27;</span> : <span class="sp-syntax-string">&#x27;closed&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>

      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">details</span>
        <span class="sp-syntax-property">open</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-definition">setIsOpen</span><span class="sp-syntax-punctuation">(</span>!<span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">)</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>Summary<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>
        Details
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">details</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span>
<span class="sp-syntax-punctuation">}</span></pre></div></div></div><button type="button" class="flex items-center justify-center flex-row gap-2 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow absolute right-0 top-3 -translate-x-1/2 transition-opacity duration-500 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto focus:opacity-100 focus:pointer-events-auto"><span class="text-[var(--code-fg)]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></span></button></div><hr/><div class="relative [&amp;_.sp-preview-container]:sm:rounded-b [&amp;_.sp-preview-container]:px-horizontal-padding [&amp;_.sp-preview-container]:pt-3 [&amp;_.sp-stack]:bg-transparent"><noscript><div class="px-horizontal-padding pt-3 text-on-background">You need to enable JavaScript to preview the code.</div></noscript><div class="sp-c-euXojQ sp-preview sp-stack" title="Fixed bug when using details element with React, using toggle event"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"></div></div></div><div class="absolute right-horizontal-padding top-3 flex space-x-2"><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Open on Codesandbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-codesandbox"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></button><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg></button></div></div></div></div></div></div></astro-island>
<p>But unfortunately, this may still cause trouble. For instance, a button that
toggles <code>isOpen</code> on click, like the “Toggle details” button below, will cause
an infinite loop:</p>
<astro-island uid="Z2sYyKq" component-url="/_astro/_InfiniteLoopBugSandpack.f0252be3.js" component-export="default" renderer-url="/_astro/client.47a71f61.js" props="{}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;_function&quot;,&quot;value&quot;:true}" await-children=""><div class="light sp-c-fVPbOs sp-c-fVPbOs-gMQIch-variant-light sp-wrapper"><div class="sp-482805736 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="my-8"><div role="tablist" class="space-x-2" style="--sandpack-surface1:#282c34;--sandpack-surface3:#2c313c;--sandpack-accent:#c678dd;--sandpack-base:#a8b1c2"><button type="button" role="tab" aria-selected="true" class="rounded-t p-2 transition-colors duration-300 border-primary [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">App.js</button></div><div class="full-width-on-mobile shadow shadow-shadow sm:rounded-b"><div class="dark group relative [&amp;_.sp-code-editor_*]:sm:rounded [&amp;_.sp-code-editor_*]:sm:rounded-tl-none"><div class="sp-c-euXojQ sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">App</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setIsOpen</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-static">false</span><span class="sp-syntax-punctuation">)</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>State: <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span> ? <span class="sp-syntax-string">&#x27;open&#x27;</span> : <span class="sp-syntax-string">&#x27;closed&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">span</span><span class="sp-syntax-punctuation">&gt;</span>

      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">details</span>
        <span class="sp-syntax-property">open</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-definition">setIsOpen</span><span class="sp-syntax-punctuation">(</span>!<span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">)</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>Summary<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">summary</span><span class="sp-syntax-punctuation">&gt;</span>
        Details
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">details</span><span class="sp-syntax-punctuation">&gt;</span>

      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-definition">setIsOpen</span><span class="sp-syntax-punctuation">(</span>!<span class="sp-syntax-plain">isOpen</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>Toggle details<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span>
<span class="sp-syntax-punctuation">}</span></pre></div></div></div><button type="button" class="flex items-center justify-center flex-row gap-2 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow absolute right-0 top-3 -translate-x-1/2 transition-opacity duration-500 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto focus:opacity-100 focus:pointer-events-auto"><span class="text-[var(--code-fg)]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></span></button></div><hr/><div class="relative [&amp;_.sp-preview-container]:sm:rounded-b [&amp;_.sp-preview-container]:px-horizontal-padding [&amp;_.sp-preview-container]:pt-3 [&amp;_.sp-stack]:bg-transparent"><noscript><div class="px-horizontal-padding pt-3 text-on-background">You need to enable JavaScript to preview the code.</div></noscript><div class="sp-c-euXojQ sp-preview sp-stack" title="Infinite loop when using details toggle event"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"></div></div></div><div class="absolute right-horizontal-padding top-3 flex space-x-2"><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Open on Codesandbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-codesandbox"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></button><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg></button></div></div></div></div></div></div></astro-island>
<p>Here’s how this happens:</p>
<ol>
<li>The button <code>onClick</code> event listener toggles <code>isOpen</code>, which changes the
<code>open</code> attribute.</li>
<li>The <code>open</code> attribute change fires the <code>toggle</code> event, which executes the
<code>onToggle</code> event listener.</li>
<li>The <code>onToggle</code> event listener toggles <code>isOpen</code>, which changes the <code>open</code>
attribute — so we’re back to step 2, hence the infinite loop.</li>
</ol>
<h2 id="what-about-other-frameworks">What about other frameworks?<a aria-hidden="true" tabindex="-1" href="#what-about-other-frameworks"><span class="icon icon-link"></span></a></h2>
<p>I later wondered if other JavaScript frameworks — specifically Solid, Svelte
and Vue — could handle this any better, so I tried to reproduce the issue
using their “playgrounds” web apps.</p>
<p>Surprisingly, <strong>they all have the same issue</strong>!</p>
<p>Here are links to playgrounds where the issue is reproduced:</p>
<ul>
<li><a href="https://sfc.vuejs.org/#eNp9Ub1OwzAQfpXDS1qpiSU6EaWlSCxMDF29hORaQv0n2ylCUd6dcxJKKFIn6/z9+tyxJ2uzc4ssZ4WvXGMDeAyt3QrdKGtcgA4cHqCHgzMKEqImQgtdGe0DNP7VooZNpCwOpfS4/AWDOR4lvvxQFkvYbKETGiZZdi5li4TczWehe6ELPnahFjQEVFaWAWkCKLwt9XYfaM6h66YGj5AYOhPIIamk8VgnfU8ukRs9SFdjKBvpIY/EjWCjUrDBNfq2SpXuC3aVbKoTEeb9LzSA/cibVHySTSkAz2PMEMmnTAILfnkFW7FxtakqbfbhjablD3uhUgPgBaO3jX6C0crjLNh7CNbnnLfano5ZZRTfEcZdq0OjMK2N2q2z+2z9wOvGh/l9hl6lb858enSUKNhqZs7p8owudahrdOhuhl1x/wReYf9CYyZ9bs/6b1lx2Hs=">Vue</a></li>
<li><a href="https://playground.solidjs.com/?version=1.4.1#NobwRAdghgtgpmAXGGUCWEwBowBcCeADgsrgM4Ae2YZA9gK4BOAxiWGjIbY7gAQi9GcCABM4jXgF9eAM0a0YvADo1aAGzQiAtACsyAegDucAEYqA3EogcuPfr2ZCouOAGU0Ac2hqps+YpU6DW09CysrGXoIZlw0WgheAGEGCBdGAAoASn4rXgd4sj5gNDIAeWIILF4yOFwASTKKgF1eAF4HJxd3Lyg1dJlemszLBPyIQt5cWg8PNTgG8uE23iy2gD5q2oWK9IBCEsWILOHw0aFcJgT03LzeAB41m9v7skIoCDXXXGc4RH4DnbZAD8vAA5LQKqDeH9Qcw1LQaiJQZI7vpXu8Nqdnnk7mJvmg1GReBDhK0QADhFlJI9RtiXvQYKhGPhiRBEhpmABrMlTGZzbbCalPOnVBlM-DC56oshiqDMmmS24AEVq6EJitReLVZBpUv0ut4JwgklOQlE4nSq1aGzuySiaV4+qqIlozAZwlwADoPLUAKJzeCpABC+DqImuYCghEIKkyuyNYEkTSAA">Solid</a></li>
<li><a href="https://svelte.dev/repl/ad0d7f727ee14f069d53503a6ae32709?version=3.50.1">Svelte</a></li>
</ul>
<h2 id="not-a-react-bug">Not a React bug?<a aria-hidden="true" tabindex="-1" href="#not-a-react-bug"><span class="icon icon-link"></span></a></h2>
<p>In light of this, <strong>I don’t think this is an issue with React</strong>.</p>
<p>It sure is an application bug, but it’s not React’s fault. The problem is that
there are more than a single source of truth controlling the <code>open</code> state,
which is asking for trouble.</p>
<p>In fact, all of this suggested to me that it would still happen in vanilla
JavaScript. And indeed it does:</p>
<astro-island uid="PbLsh" component-url="/_astro/_BugVanillaSandpack.c98153da.js" component-export="default" renderer-url="/_astro/client.47a71f61.js" props="{}" ssr="" client="visible" opts="{&quot;name&quot;:&quot;_function$3&quot;,&quot;value&quot;:true}" await-children=""><div class="light sp-c-fVPbOs sp-c-fVPbOs-gMQIch-variant-light sp-wrapper"><div class="sp-482805736 sp-c-fVPbOs sp-c-fVPbOs-LrWkf-variant-dark sp-wrapper"><div class="my-8"><div role="tablist" class="space-x-2" style="--sandpack-surface1:#282c34;--sandpack-surface3:#2c313c;--sandpack-accent:#c678dd;--sandpack-base:#a8b1c2"><button type="button" role="tab" aria-selected="false" class="rounded-t p-2 transition-colors duration-300 [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">src/index.js</button><button type="button" role="tab" aria-selected="true" class="rounded-t p-2 transition-colors duration-300 border-primary [&amp;[aria-selected=true]]:bg-[var(--sandpack-surface1)] [&amp;[aria-selected=true]]:text-[var(--sandpack-accent)] [&amp;[aria-selected=true]]:shadow [&amp;[aria-selected=true]]:shadow-shadow hover:bg-[var(--sandpack-surface3)] hover:text-[var(--sandpack-base)] border-b-0 font-normal">index.js</button></div><div class="full-width-on-mobile shadow shadow-shadow sm:rounded-b"><div class="dark group relative [&amp;_.sp-code-editor_*]:sm:rounded [&amp;_.sp-code-editor_*]:sm:rounded-tl-none"><div class="sp-c-euXojQ sp-editor sp-stack"><div class="sp-c-gtcpyq sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for index.js" aria-multiline="true" class="sp-pristine sp-javascript sp-c-jOWzsE sp-c-jkvvao sp-cm" role="textbox" tabindex="0" translate="no"><pre class="sp-c-fWymNx sp-pre-placeholder" style="margin-left:var(--sp-space-5)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-string">&quot;./styles.css&quot;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-plain">document</span>.<span class="sp-syntax-property">getElementById</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-string">&quot;app&quot;</span><span class="sp-syntax-punctuation">)</span>.<span class="sp-syntax-property">innerHTML</span> = <span class="sp-syntax-string">`
&lt;h1&gt;Hello world&lt;/h1&gt;
`</span><span class="sp-syntax-punctuation">;</span>

</pre></div></div></div><button type="button" class="flex items-center justify-center flex-row gap-2 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow absolute right-0 top-3 -translate-x-1/2 transition-opacity duration-500 opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto focus:opacity-100 focus:pointer-events-auto"><span class="text-[var(--code-fg)]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path></svg></span></button></div><hr/><div class="relative [&amp;_.sp-preview-container]:sm:rounded-b [&amp;_.sp-preview-container]:px-horizontal-padding [&amp;_.sp-preview-container]:pt-3 [&amp;_.sp-stack]:bg-transparent"><noscript><div class="px-horizontal-padding pt-3 text-on-background">You need to enable JavaScript to preview the code.</div></noscript><div class="sp-c-euXojQ sp-preview sp-stack" title="The same bug observed when using details element can be reproduced with vanilla JavaScript"><div class="sp-c-juMdfR sp-preview-container"><iframe class="sp-c-fgviib sp-preview-iframe" title="Sandpack Preview"></iframe><div class="sp-c-kwibBT sp-preview-actions"></div></div></div><div class="absolute right-horizontal-padding top-3 flex space-x-2"><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Open on Codesandbox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-codesandbox"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline><polyline points="7.5 19.79 7.5 14.6 3 12"></polyline><polyline points="21 12 16.5 14.6 16.5 19.79"></polyline><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></button><button type="button" class="flex items-center justify-center flex-row gap-2 transition-colors duration-300 hover:bg-hover disabled:bg-disabled disabled:text-on-disabled disabled:hover:cursor-not-allowed disabled:hover:bg-disabled bg-background text-on-background rounded border border-divider p-1 shadow shadow-shadow" aria-label="Refresh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg></button></div></div></div></div></div></div></astro-island>
<h2 id="closing-thoughts">Closing thoughts<a aria-hidden="true" tabindex="-1" href="#closing-thoughts"><span class="icon icon-link"></span></a></h2>
<p>In conclusion, this seems to be a more fundamental issue with how the <code>details</code>
element work. For now, there’s no way around it than just get used to
immediately calling <code>e.preventDefault()</code> on <code>summary</code>’s <code>onClick</code> event
handlers when controlling the <code>details</code> <code>open</code> attribute, which will let React
be the single source of truth for its state.</p>

          </div>

          <aside class="min-w-0">
            <div style="--offset-from-top:1rem" class="w-full rounded shadow-sm shadow-shadow lg:sticky lg:top-[var(--offset-from-top)] lg:h-[calc(100vh-var(--offset-from-top)_*_2)] lg:bg-surface lg:p-4">
      <div class="hidden lg:flex lg:h-full lg:flex-col">
        <div class="flex justify-between gap-2">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>

            <h2 class="m-0">Table of Contents</h2>
          </div>

          <div class="flex items-center transition-transform duration-100 ease-in group-open:rotate-180 lg:hidden">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </div>
        </div>

        <div data-toc-wrapper class="
          mt-4
          min-h-0
          sm:overflow-y-auto
          [&_a_*]:indent-0
          [&_nav_ol]:m-0
          [&_nav_ol]:list-none
          [&_nav_ol]:indent-4
          [&_nav_ol_li[data-active]>a]:text-primary
          [&_nav_ol_li[data-active]]:before:bg-primary
          [&_nav_ol_li]:relative
          [&_nav_ol_li]:before:absolute
          [&_nav_ol_li]:before:left-0
          [&_nav_ol_li]:before:top-0
          [&_nav_ol_li]:before:h-full
          [&_nav_ol_li]:before:w-[1px]
          [&_nav_ol_li]:before:bg-divider
          [&_nav_ol_li]:before:content-['']
          [&_nav_ol_li_a:hover]:bg-hover
          [&_nav_ol_li_a]:block
          [&_nav_ol_li_a]:truncate
          [&_nav_ol_li_a]:border-b-0
          [&_nav_ol_li_a]:transition-colors
          [&_nav_ol_li_a]:duration-300
          [&_nav_ol_ol]:indent-8
          [&_nav_ol_ol_ol]:indent-12
          [&_nav_ol_ol_ol_ol]:indent-16
       ">
          <nav data-toc>
  <ol>
  <li>
          <a href="#why">Why?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#workarounds">Workarounds</a>

          <ol>
  <li>
          <a href="#epreventdefault">e.preventDefault()</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#toggle-event">toggle event</a>

          <ol>
  
</ol>
        </li>
</ol>
        </li><li>
          <a href="#what-about-other-frameworks">What about other frameworks?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#not-a-react-bug">Not a React bug?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#closing-thoughts">Closing thoughts</a>

          <ol>
  
</ol>
        </li>
</ol>
</nav>
        </div>
      </div>

      <details class="card group mb-8 max-w-prose px-horizontal-padding py-4 lg:hidden" aria-label="Table of Contents">
        <summary class="list-none">
          <div class="flex justify-between gap-2">
            <div class="flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>

              <h2 class="m-0">Table of Contents</h2>
            </div>

            <div class="flex items-center transition-transform duration-100 ease-in group-open:rotate-180 lg:hidden">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </div>
          </div>
        </summary>

        <div class="
          mt-4
          [&_ol]:m-0
          [&_ol]:list-outside
          [&_ol]:px-horizontal-padding
          [&_ol_li:not(:first-child)]:mt-1
        ">
          <nav data-toc>
  <ol>
  <li>
          <a href="#why">Why?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#workarounds">Workarounds</a>

          <ol>
  <li>
          <a href="#epreventdefault">e.preventDefault()</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#toggle-event">toggle event</a>

          <ol>
  
</ol>
        </li>
</ol>
        </li><li>
          <a href="#what-about-other-frameworks">What about other frameworks?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#not-a-react-bug">Not a React bug?</a>

          <ol>
  
</ol>
        </li><li>
          <a href="#closing-thoughts">Closing thoughts</a>

          <ol>
  
</ol>
        </li>
</ol>
</nav>
        </div>
      </details>
    </div>
          </aside>
        </div>
      </article>

      <hr class="full-width-on-mobile mt-8">

      <nav class="flex items-stretch sm:gap-4 full-width-on-mobile sm:my-8" aria-label="Posts navigation">
  <a class="sm:card flex max-w-1/2 flex-1 flex-col gap-2 border-0 px-horizontal-padding py-4 transition-colors duration-300 hover:bg-hover" href="/posts/how-not-to-write-forms-in-react">
        <span class="text-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </span>

        How not to write forms with React
      </a>

  <div class="border-l border-divider sm:hidden"></div>

  <a class="sm:card flex max-w-1/2 flex-1 flex-col-reverse items-end justify-end gap-2 border-0 px-horizontal-padding py-4 text-right transition-colors duration-300 hover:bg-hover" href="/posts/code-formatting-vim">
        Ergonomic mappings for code formatting in Vim

        <span class="text-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
        </span>
      </a>
</nav>

      <hr class="full-width-on-mobile mb-8">
    </div>
  </main>


    <footer class="border-t border-divider bg-background sm:border-0">
  <div class="mx-auto flex w-full max-w-content flex-col items-center px-horizontal-padding pt-4 pb-8 sm:justify-between">
    <nav aria-label="Contacts" class="flex gap-2">
  <a class="rounded-full transition-colors duration-300 hover:bg-hover p-2 [&_svg]:transition-colors [&_svg]:duration-300 hover:text-primary border-0" id="contact-email" href="phelipe_teles@hotmail.com" aria-label="E-mail">
  
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail"><rect x="2" y="4" width="20" height="16" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
  
</a>

  <a class="rounded-full transition-colors duration-300 hover:bg-hover p-2 [&_svg]:transition-colors [&_svg]:duration-300 hover:text-primary border-0" id="contact-linkedin" href="https://linkedin.com/in/phelipeteles" aria-label="LinkedIn">
  
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
  
</a>

  <a class="rounded-full transition-colors duration-300 hover:bg-hover p-2 [&_svg]:transition-colors [&_svg]:duration-300 hover:text-primary border-0" id="contact-github" href="https://github.com/phelipetls" aria-label="GitHub">
  
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg>
  
</a>
</nav>

    <span class="text-center">All content is under a
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0</a>
license.
</span>
  </div>
</footer>
  </body></html>