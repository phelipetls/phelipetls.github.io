<!doctype html><html class="scroll-smooth scroll-pt-nav-height sm:scroll-pt-0
h-full text-base selection:bg-on-background selection:text-background sm:text-lg" lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=deploy-date content="2022-11-05"><meta name=author content="Phelipe Teles"><meta name=color-scheme content="dark light"><style>@font-face{font-family:fira sans;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/fira-sans-v16-latin-regular.woff2)format('woff2')}@font-face{font-family:fira sans;font-style:normal;font-weight:600;font-display:swap;src:url(/fonts/fira-sans-v16-latin-600.woff2)format('woff2')}@font-face{font-family:merriweather;font-style:normal;font-weight:400;font-display:swap;src:url(/fonts/merriweather-v30-latin-regular.woff2)format('woff2')}@font-face{font-family:merriweather;font-style:normal;font-weight:700;font-display:swap;src:url(/fonts/merriweather-v30-latin-700.woff2)format('woff2')}</style><script async defer data-website-id=32b90065-c2a6-4390-9684-dfde99409815 src=https://umami-production-10b2.up.railway.app/main.js></script>
<script type=module defer src=https://phelipetls.github.io/js/bundle.min.js></script><meta name=description content="Front-end web developer that writes about the programming craft and its tools"><meta name=publish-date content="2021-09-15"><meta name=last-modified-date content="2022-09-23"><meta name=keywords content="typescript,vim,nvim,lua"><title>Making Vim understand TypeScript path mapping |
Phelipe Teles</title><meta property="og:title" content="Making Vim understand TypeScript path mapping"><meta property="og:description" content="Vim has this well-known feature of opening the path under cursor with 


:h gf
. 


This article
explains well how this
works
."><meta property="og:type" content="article"><meta property="og:url" content="https://phelipetls.github.io/posts/making-vim-understand-typescript-path-mapping/"><meta property="og:image" content="https://phelipetls.github.io/posts/making-vim-understand-typescript-path-mapping/post-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-23T15:18:05-03:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://phelipetls.github.io/posts/making-vim-understand-typescript-path-mapping/post-image.png"><meta name=twitter:title content="Making Vim understand TypeScript path mapping"><meta name=twitter:description content="Vim has this well-known feature of opening the path under cursor with 


:h gf
. 


This article
explains well how this
works
."><link rel=stylesheet href="/css/main.min.css"><link rel=stylesheet href=https://phelipetls.github.io/css/vendor/lite-yt-embed.min.css><link rel=stylesheet href=/css/dark-syntax-highlight.min.css></head><body data-preload class="ease h-full bg-background font-sans text-on-background transition-colors duration-500"><script>(()=>{window.__setTheme=s;var e=o();window.__setTheme(e),window.addEventListener("load",function(){document.body.removeAttribute("data-preload"),t(e)}),window.addEventListener("storage",function(e){const t=e.newValue;e.key==="__theme"&&window.__setTheme(t)});function s(e){if(!e)return;a(e),c(e),t(e)}function c(e){localStorage.setItem("__theme",e)}function o(){return localStorage.getItem("__theme")||"system"}function i(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function n(e){return e==="system"?i():e}function a(e){const t=n(e);document.body.classList.toggle("dark",t==="dark")}function r(e){return new CustomEvent("newTheme",{detail:{themeChoice:e,theme:n(e)}})}function t(e){document.body.dispatchEvent(r(e))}})()</script><div class="relative flex h-full flex-col"><div data-nav-container class="mb-8 w-full"><div class="pt-nav-height sm:hidden"><nav class="fixed top-0 left-0 z-30 flex w-screen justify-between rounded-none border-b border-divider bg-background/90 py-4 px-horizontal-padding backdrop-blur" aria-label="Main navigation"><div class="flex flex-row items-center gap-2 overflow-hidden"><a class=border-0 href=https://phelipetls.github.io/posts/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"/></svg></a><h2 class="m-0 truncate font-sans font-normal">Making Vim understand TypeScript path mapping</h2></div><button data-a11y-dialog-show=sidenav class="btn btn-icon" aria-label="Open navigation sidebar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></nav></div><div class="hidden h-full w-full sm:block"><div class="flex h-full w-full items-center justify-between bg-background pr-horizontal-padding"><div class="mx-auto flex h-full w-full max-w-content justify-between"><nav class="flex h-full justify-between overflow-x-auto px-horizontal-padding" aria-label="Main navigation"><ul class="m-0 flex list-none flex-row flex-nowrap items-center gap-2"><li><a id=about href=https://phelipetls.github.io/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>About</span></a></li><li><a id=posts href=https://phelipetls.github.io/posts/ aria-current=page class="bg-primary card hover:bg-primary-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span class=text-on-primary>Posts</span></a></li><li><a id=projects href=https://phelipetls.github.io/projects/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>Projects</span></a></li><li><a id=resume href=https://phelipetls.github.io/resume/ class="hover:bg-hover
relative
flex
items-center
justify-center
rounded
border-0
py-1
px-2
transition-colors
duration-300"><span>Résumé</span></a></li></ul></nav><div class="h-full py-3"><div class="flex h-full flex-row items-stretch gap-2 pl-2"><div class="relative flex h-full flex-row items-center"><span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm"><svg class="feather" viewBox="0 0 24 24" width="24" height="24"><title>Theme icon</title><defs><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></defs><use data-theme-select-icon href=#monitor></use></svg></span>
<select class="card h-full appearance-none bg-surface py-1 px-8 text-center" data-theme-select id=theme-select aria-label="Choose a theme"><option value=light>Light</option><option value=dark>Dark</option><option value=system>System</option></select>
<span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></div></div></div></div></div></div></div><aside data-a11y-dialog=sidenav aria-hidden=true class="fixed z-50 h-full w-full" style=visibility:hidden><div data-a11y-dialog-hide class="fixed inset-0 -z-1 w-full bg-neutral-700 bg-opacity-75 backdrop-blur-sm"></div><div role=document class="ml-auto h-full w-3/4 rounded-none bg-background py-0 will-change-transform"><div class="flex h-full flex-col justify-between"><div class="mb-2 flex h-nav-height items-center justify-end px-horizontal-padding"><button data-a11y-dialog-hide class="btn btn-icon" aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div><nav class="flex flex-1 flex-col"><ul class="m-0 flex list-none flex-col items-center justify-center gap-4 px-horizontal-padding"><li class=w-full><a id=about href=https://phelipetls.github.io/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">About</a></li><li class=w-full><a id=posts href=https://phelipetls.github.io/posts/ aria-current=page class="card bg-primary text-on-primary hover:bg-primary-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Posts</a></li><li class=w-full><a id=projects href=https://phelipetls.github.io/projects/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Projects</a></li><li class=w-full><a id=resume href=https://phelipetls.github.io/resume/ class="hover:bg-hover
block
w-full
rounded
border-0
p-2
text-center
text-xl
transition-colors
duration-300">Résumé</a></li></ul></nav><div class="mb-4 flex h-12 flex-row items-center justify-center px-horizontal-padding"><div class="relative flex h-full flex-row items-center"><span class="pointer-events-none absolute left-2 top-1/2 -translate-y-1/2 text-sm"><svg class="feather" viewBox="0 0 24 24" width="24" height="24"><title>Theme icon</title><defs><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg id="monitor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-monitor"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></defs><use data-theme-select-icon href=#monitor></use></svg></span>
<select class="card h-full appearance-none bg-surface py-1 px-8 text-center" data-theme-select id=theme-select aria-label="Choose a theme"><option value=light>Light</option><option value=dark>Dark</option><option value=system>System</option></select>
<span class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></div></div></div></div></aside><main class="grid grid-cols-layout"><div class="col-full max-w-full rounded-none px-horizontal-padding pt-8 shadow-none sm:col-content sm:px-0"><article><header><h1 class="mb-4 text-4xl">Making Vim understand TypeScript path mapping</h1><div class="mb-4 flex flex-col gap-2"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg><div>1 min.</div></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><time datetime=2021-09-15>September 15, 2021</time></div></div><div class="mb-4 flex flex-wrap gap-2"><a href=/tags/typescript/ class="tag whitespace-nowrap">typescript</a>
<a href=/tags/vim/ class="tag whitespace-nowrap">vim</a>
<a href=/tags/nvim/ class="tag whitespace-nowrap">nvim</a>
<a href=/tags/lua/ class="tag whitespace-nowrap">lua</a>
<a href=/tags class=tag aria-label="All tags">...</a></div></header><hr class=my-8><div class="flex flex-col-reverse lg:grid lg:grid-cols-[1fr,minmax(0,1fr)]"><div data-blog-post class="[&>pre]:full-width-on-mobile
       [&>figure]:full-width-on-mobile
    [&>[data-codeblock]]:full-width-on-mobile
max-w-prose
[&>[data-codeblock]_pre]:max-sm:rounded-none
[&>[data-codeblock-with-header]]:mt-16
[&_img]:mx-auto
              [&>hr]:border-0
[&>hr]:text-center
              [&>hr]:after:content-['⁂']
[&>pre]:my-8
              [&>figure]:my-8
[&>blockquote]:my-8
              [&>figure_img]:bg-surface
          [&>figure_img]:sm:rounded
          [&>figure_video]:min-h-[15em]
      [&>figure_video]:bg-surface
        [&>figure_video]:sm:rounded
        [&_.katex-display]:overflow-x-auto
 [&_.katex-display]:overflow-y-hidden"><p>Vim has this well-known feature of opening the path under cursor with
<a href=http://vimdoc.sourceforge.net/htmldoc/editing.html#gf rel=external><code>:h gf</code><span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>.
<a href=https://vim.fandom.com/wiki/Open_file_under_cursor rel=external>This article
explains well how this
works<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>.</p><p>Things work out of the box with full paths with no special characters, like
<code>/home/phelipe/script.js</code>, but it also expands <code>~</code> and environment variables,
like <code>$HOME/script.js</code> or <code>~/script.js</code>.</p><p>Things don&rsquo;t work well when languages have special syntax to import a file,
which is most languages. For example, Java:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ea2d2e" d="M47.617 98.12c-19.192 5.362 11.677 16.439 36.115 5.969-4.003-1.556-6.874-3.351-6.874-3.351-10.897 2.06-15.952 2.222-25.844 1.092-8.164-.935-3.397-3.71-3.397-3.71zm33.189-10.46c-14.444 2.779-22.787 2.69-33.354 1.6-8.171-.845-2.822-4.805-2.822-4.805-21.137 7.016 11.767 14.977 41.309 6.336-3.14-1.106-5.133-3.131-5.133-3.131zm11.319-60.575c.001.0-42.731 10.669-22.323 34.187 6.024 6.935-1.58 13.17-1.58 13.17s15.289-7.891 8.269-17.777c-6.559-9.215-11.587-13.793 15.634-29.58zm9.998 81.144s3.529 2.91-3.888 5.159c-14.102 4.272-58.706 5.56-71.095.171-4.45-1.938 3.899-4.625 6.526-5.192 2.739-.593 4.303-.485 4.303-.485-4.952-3.487-32.013 6.85-13.742 9.815 49.821 8.076 90.817-3.637 77.896-9.468zM85 77.896c2.395-1.634 5.703-3.053 5.703-3.053s-9.424 1.685-18.813 2.474c-11.494.964-23.823 1.154-30.012.326-14.652-1.959 8.033-7.348 8.033-7.348s-8.812-.596-19.644 4.644C17.455 81.134 61.958 83.958 85 77.896zm5.609 15.145c-.108.29-.468.616-.468.616 31.273-8.221 19.775-28.979 4.822-23.725-1.312.464-2 1.543-2 1.543s.829-.334 2.678-.72c7.559-1.575 18.389 10.119-5.032 22.286zM64.181 70.069c-4.614-10.429-20.26-19.553.007-35.559C89.459 14.563 76.492 1.587 76.492 1.587c5.23 20.608-18.451 26.833-26.999 39.667-5.821 8.745 2.857 18.142 14.688 28.815zm27.274 51.748c-19.187 3.612-42.854 3.191-56.887.874.0.0 2.874 2.38 17.646 3.331 22.476 1.437 57-.8 57.816-11.436.001.0-1.57 4.032-18.575 7.231z"/></svg width="24" height="24"></div></div><div>Java</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span> <span class=nn>foo.bar</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>Or Python:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#ffd845" d="M49.33 62h29.159C86.606 62 93 55.132 93 46.981V19.183c0-7.912-6.632-13.856-14.555-15.176-5.014-.835-10.195-1.215-15.187-1.191-4.99.023-9.612.448-13.805 1.191C37.098 6.188 35 10.758 35 19.183V30h29v4H23.776c-8.484.0-15.914 5.108-18.237 14.811-2.681 11.12-2.8 17.919.0 29.53C7.614 86.983 12.569 93 21.054 93H31V79.952C31 70.315 39.428 62 49.33 62zm-1.838-39.11c-3.026.0-5.478-2.479-5.478-5.545.0-3.079 2.451-5.581 5.478-5.581 3.015.0 5.479 2.502 5.479 5.581-.001 3.066-2.465 5.545-5.479 5.545zm74.789 25.921C120.183 40.363 116.178 34 107.682 34H97v12.981C97 57.031 88.206 65 78.489 65H49.33C41.342 65 35 72.326 35 80.326v27.8c0 7.91 6.745 12.564 14.462 14.834 9.242 2.717 17.994 3.208 29.051.0C85.862 120.831 93 116.549 93 108.126V97H64v-4h43.682c8.484.0 11.647-5.776 14.599-14.66 3.047-9.145 2.916-17.799.0-29.529zm-41.955 55.606c3.027.0 5.479 2.479 5.479 5.547.0 3.076-2.451 5.579-5.479 5.579-3.015.0-5.478-2.502-5.478-5.579.0-3.068 2.463-5.547 5.478-5.547z"/></svg width="24" height="24"></div></div><div>Python</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>module</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>.module</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>..module</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>But it&rsquo;s possible to configure Vim to understand this special syntax with the
<a href=http://vimdoc.sourceforge.net/htmldoc/options.html#%27includeexpr%27 rel=external><code>:h includeexpr</code><span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a>
option, which is a function that receives the filename in the special variable
<code>v:fname</code> so you can manipulate it.</p><p>For Java, such a function could just replace <code>.</code> with <code>/</code>, but for Python
<a href=https://github.com/vim/vim/blob/4b4b1b84eee70b74fa3bb57624533c65bafd8428/runtime/ftplugin/python.vim#L19,L35 rel=external>it&rsquo;s
more
complicated<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>.</p><p>In the JavaScript world this is even more complex&mldr; We have
<a href=https://webpack.js.org/configuration/resolve/ rel=external>webpack
aliases<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>,
<a href=https://jestjs.io/docs/configuration#modulenamemapper-objectstring-string--arraystring rel=external>Jest&rsquo;s
moduleNameMapper<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a>
and much more.</p><p>The TypeScript compiler has this feature as well, it&rsquo;s called
<a href=https://www.typescriptlang.org/docs/handbook/module-resolution.html#path-mapping rel=external>path
mapping<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>.</p><p>For example, to import a component from <code>src/components</code> from anywhere with
just <code>~/components</code>, you&rsquo;d use the following <code>tsconfig.json</code>:</p><div data-codeblock class="mt-8
group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;compilerOptions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;baseUrl&#34;</span><span class=p>:</span> <span class=s2>&#34;.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;paths&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;~/*&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;src/*&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>This is great but it breaks <code>gf</code>, so in this post I want to share how to make
it work again for TypeScript projects that use this feature.</p><h2 class="mb-8 mt-4 pt-4" id=why-not-lsp>Why not LSP?
<a class="text-primary border-0" href=#why-not-lsp>#</a></h2><p>You might be wondering why not just use a language server for that?</p><p>And you&rsquo;d be right, that&rsquo;s certainly better than implementing the TypeScript
module resolution algorithm in Lua&mldr;</p><p>But the TypeScript language servers are very resource hungry and slow to boot,
so I find that it does pay off to use a dumber way to navigate files with
built-in Vim features in case the language server is still booting or just
being slow.</p><h2 class="mb-8 mt-4 pt-4" id=implementation-details>Implementation details
<a class="text-primary border-0" href=#implementation-details>#</a></h2><p>Our goal is to pass a function to the <code>includeexpr</code> option that will try to
substitute the &ldquo;alias&rdquo; (<code>~/*</code>) with its associated path (<code>src/*</code>) until it
finds a file/directory that exists, then return it. Otherwise, return <code>nil</code>.</p><p>I decided to write it in Lua in the <code>lua/tsconfig.lua</code> module. Here&rsquo;s how we
can configure the <code>includeexpr</code> for JavaScript/TypeScript to use this lua
function:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><path fill="#179a33" d="M72.6 80.5c.2.2.6.5.9.5h5.3c.3.0.7-.3.9-.5l1.4-1.5c.2-.2.3-.4.3-.6l1.5-5.1c.1-.5.0-1-.3-1.3l-1.1-.9c-.2-.2-.6-.1-.9-.1h-4.8l-.2-.2-.1-.1c-.2.0-.4-.1-.6.1L73 72c-.2.0-.3.5-.4.7L71 77.6c-.2.5-.1 1.1.3 1.5l1.3 1.4zm.8 26.4-.4.1h-1.2L79 85.9c.2-.7-.1-1.5-.8-1.7l-.4-.1H65.7c-.5.1-.9.5-1 1l-.7 2.5c-.2.7.3 1.3 1 1.5l.3-.1h1.8l-7.3 20.9c-.2.7.1 1.6.8 1.9l.4.3h11.2c.6.0 1.1-.5 1.3-1.1l.7-2.4c.3-.7-.1-1.5-.8-1.7zm53.1-19.7-1.9-2.5v-.1c-.3-.3-.6-.6-1-.6h-7.2c-.4.0-.7.4-1 .6l-2 2.4h-3.1l-2.1-2.4v-.1c-.2-.3-.6-.5-1-.5h-4l20.2-20.2-22.6-22.4L121 20.6v-9L118.2 8H77.3L74 11.5v2.9L62.7 3 55 10.5 52.6 8H12.2L9 11.7v9.4l3 2.9h3v26.1l-14 14 14 14v32l5.2 2.9h11.6l9.1-9.5 21.6 21.6L77 110.6c.1.4.4.5.9.7l.4-.2h9.4c.6.0 1.1-.1 1.2-.6l.7-2c.2-.7-.1-1.3-.8-1.5l-.4.1H88l3.4-10.7 2.3-2.3h5l-5 15.9c-.2.7.2 1.1.9 1.4l.4-.2h9.1c.5.0 1-.1 1.2-.6l.8-1.8c.3-.7-.1-1.3-.7-1.6-.1-.1-.3.0-.5.0h-.4l4.2-13h6.1l-5.1 15.9c-.2.7.2 1.1.9 1.3l.4-.3h10c.5.0 1-.1 1.2-.6l.8-2c.3-.7-.1-1.3-.8-1.5-.1-.1-.3.1-.5.1h-.7l5.6-18.5c.2-.5.1-1.1-.1-1.4zM62.7 4.9 74 16.2v4.7l3.4 4.1H79L50 53V25h3.3l2.7-4.2v-8.9l-.2-.3 6.9-6.7zM2.9 64.1 15 52v24.2L2.9 64.1zm38.9 38.3 58.4-60 21.4 21.5-20.2 20.2h-.1c-.3.1-.5.3-.7.5L98.5 87h-2.9l-2.2-2.4c-.2-.3-.6-.6-1-.6h-8.8c-.6.0-1.1.4-1.3 1l-.8 2.5c-.2.7.1 1.3.8 1.6h1.5L77.4 108l-15.1 15.2-20.5-20.8z"/></svg width="24" height="24"></div></div><div>Vim</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=c>&#34; after/ftplugin/javascript.vim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>&#34; after/ftplugin/typescript.vim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; It&#39;s common in JavaScript to omit the file extension</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>&#34; Also some plugins mess this up so I overwite it...</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>setlocal</span> <span class=nx>suffixesadd</span><span class=p>=</span>.<span class=nx>js</span><span class=p>,</span>.<span class=nx>jsx</span><span class=p>,</span>.<span class=nx>ts</span><span class=p>,</span>.<span class=nx>tsx</span><span class=p>,</span>.<span class=nx>d</span>.<span class=nx>ts</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>if</span> <span class=nx>has</span><span class=p>(</span><span class=s2>&#34;nvim&#34;</span><span class=p>)</span><span class=err>
</span></span></span><span class="line hl"><span class=cl><span class=err></span>  <span class=nx>setlocal</span> <span class=nx>includeexpr</span><span class=p>=</span><span class=nx>luaeval</span><span class=p>(</span>\<span class=s2>&#34;require&#39;tsconfig&#39;.includeexpr(_A)\&#34;</span><span class=p>,</span><span class=nx>v</span>:<span class=nx>fname</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>endif</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>And here&rsquo;s an skeleton of the Lua module:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=c1>-- lua/tsconfig.lua</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>M</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>expand_tsconfig_path</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>tsconfig_file</span> <span class=o>=</span> <span class=n>get_tsconfig_file</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>tsconfig_file</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=n>input</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>alias_to_paths</span> <span class=o>=</span> <span class=n>get_tsconfig_paths</span><span class=p>(</span><span class=n>tsconfig_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>alias_to_paths</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=n>input</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>for</span> <span class=n>alias</span><span class=p>,</span> <span class=n>path</span> <span class=kr>in</span> <span class=n>pairs</span><span class=p>(</span><span class=n>alias_to_paths</span><span class=p>)</span> <span class=kr>do</span>
</span></span><span class=line><span class=cl>    <span class=c1>-- TODO: work to find a file that exists</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>function</span> <span class=nc>M</span><span class=p>.</span><span class=nf>includeeexpr</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>path</span> <span class=o>=</span> <span class=n>expand_tsconfig_path</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>path</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>return</span> <span class=n>M</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>How exactly we try to find a file will be explained later.</p><h3 class="mb-8 mt-4 pt-4" id=finding-tsconfigjson>Finding <code>tsconfig.json</code>
<a class="text-primary border-0" href=#finding-tsconfigjson>#</a></h3><p>Let&rsquo;s start with the <code>get_tsconfig_file</code> function. We can do this by searching
upwards starting from the current file&rsquo;s directory with the
<a href=https://vimhelp.org/eval.txt.html#findfile%28%29 rel=external><code>:h findfile</code><span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a> function:
<code>findfile('tsconfig.json', '.;')</code>.</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>get_tsconfig_file</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>find_file</span><span class=p>(</span><span class=s2>&#34;tsconfig.json&#34;</span><span class=p>,</span> <span class=s2>&#34;.;&#34;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>find_file</span><span class=p>(</span><span class=s2>&#34;jsconfig.json&#34;</span><span class=p>,</span> <span class=s2>&#34;.;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>You&rsquo;ll notice the <code>find_file</code> usage, which is just a wrapper around <code>findfile</code>
that returns <code>nil</code> if it doesn&rsquo;t find one (empty strings are not falsy in Lua):</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>find_file</span><span class=p>(</span><span class=n>fname</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>found</span> <span class=o>=</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>findfile</span><span class=p>(</span><span class=n>fname</span><span class=p>,</span> <span class=n>path</span> <span class=ow>or</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=n>found</span> <span class=o>~=</span> <span class=s2>&#34;&#34;</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>I use a similar function called <code>find_dir</code> that wraps <code>:h finddir</code>.</p><h3 class="mb-8 mt-4 pt-4" id=reading-json-with-comments>Reading JSON with comments
<a class="text-primary border-0" href=#reading-json-with-comments>#</a></h3><p>We also need to read the <code>tsconfig.json</code> file. Vim has a function to serialize
JSON,
<a href=https://vimhelp.org/eval.txt.html#json_decode%28%29 rel=external><code>:h json_decode</code><span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>,
which is great, except that <code>tsconfig.json</code> is not strictly JSON, since it
allows comments. No problem, we can just remove them before we pass it to
<code>json_decode</code>:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>remove_comments</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>line</span><span class=p>:</span><span class=n>gsub</span><span class=p>(</span><span class=s2>&#34;/%*.*%*/&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>):</span><span class=n>gsub</span><span class=p>(</span><span class=s2>&#34;//.*&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>decode_json_with_comments</span><span class=p>(</span><span class=n>fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>json_without_comments</span> <span class=o>=</span> <span class=n>vim.tbl_map</span><span class=p>(</span><span class=n>remove_comments</span><span class=p>,</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>readfile</span><span class=p>(</span><span class=n>fname</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>json_decode</span><span class=p>(</span><span class=n>json_without_comments</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><h3 class="mb-8 mt-4 pt-4" id=parsing-compileroptionspaths>Parsing <code>compilerOptions.paths</code>
<a class="text-primary border-0" href=#parsing-compileroptionspaths>#</a></h3><p>Next step is to parse <code>compilerOptions.paths</code> to create a table that maps
aliases into their full paths. For example, given this configuration:</p><div data-codeblock class="mt-8
group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;compilerOptions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;baseUrl&#34;</span><span class=p>:</span> <span class=s2>&#34;.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;paths&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;~/*&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;src/*&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>We want something like this:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;~/*&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>get_full_path</span><span class=p>(</span><span class=n>base_url</span><span class=p>)</span> <span class=o>..</span> <span class=s2>&#34;src/&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><p>This is because paths are relative to <code>compilerOptions.baseUrl</code>. Also, we
should remove the catch-all character <code>*</code>:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>get_dir</span><span class=p>(</span><span class=n>fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>fnamemodify</span><span class=p>(</span><span class=n>fname</span><span class=p>,</span> <span class=s2>&#34;:h&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>get_tsconfig_paths</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>tsconfig_fname</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>json</span> <span class=o>=</span> <span class=n>decode_json_with_comments</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>base_url</span> <span class=o>=</span> <span class=n>json</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span><span class=p>.</span><span class=n>baseUrl</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>alias</span><span class=o>-</span><span class=n>to_paths</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=n>json</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span><span class=p>.</span><span class=n>paths</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>for</span> <span class=n>alias</span><span class=p>,</span> <span class=n>paths</span> <span class=kr>in</span> <span class=n>pairs</span><span class=p>(</span><span class=n>json.compilerOptions</span><span class=p>.</span><span class=n>paths</span><span class=p>)</span> <span class=kr>do</span>
</span></span><span class=line><span class=cl>      <span class=n>alias_to_paths</span><span class=p>[</span><span class=n>alias</span><span class=p>]</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>vim.tbl_map</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=kr>function</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class="line hl"><span class=cl>          <span class=kr>return</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>simplify</span><span class=p>(</span><span class=n>get_dir</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>)</span> <span class=o>..</span> <span class=s2>&#34;/&#34;</span> <span class=o>..</span> <span class=n>base_url</span> <span class=o>..</span> <span class=s2>&#34;/&#34;</span> <span class=o>..</span> <span class=n>path</span><span class=p>:</span><span class=n>gsub</span><span class=p>(</span><span class=s2>&#34;*&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=kr>end</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>paths</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>end</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>alias_to_paths</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><h3 class="mb-8 mt-4 pt-4" id=expand-tsconfig>Expand tsconfig
<a class="text-primary border-0" href=#expand-tsconfig>#</a></h3><p>Now let&rsquo;s remove that TODO we left earlier.</p><p>We just need to &ldquo;expand&rdquo; (replace) the alias with its path until we find a file
that exist.</p><p>First, we check if the input filename matches the alias (e.g., <code>~/file</code> should
match <code>~/*</code> but also <code>*</code> since it means any value), replace the alias with its
path (<code>~/file</code> -> <code>src/file</code>) and try to find it:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>expand_tsconfig_path</span><span class=p>(</span><span class=n>input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>-- ...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>for</span> <span class=n>alias</span><span class=p>,</span> <span class=n>paths</span> <span class=kr>in</span> <span class=n>pairs</span><span class=p>(</span><span class=n>alias_to_paths</span><span class=p>)</span> <span class=kr>do</span>
</span></span><span class="line hl"><span class=cl>    <span class=kr>if</span> <span class=n>alias</span> <span class=o>==</span> <span class=s2>&#34;*&#34;</span> <span class=ow>or</span> <span class=n>vim.startswith</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>alias</span><span class=p>:</span><span class=n>gsub</span><span class=p>(</span><span class=s2>&#34;*&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>      <span class=kr>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>path</span> <span class=kr>in</span> <span class=n>pairs</span><span class=p>(</span><span class=n>paths</span><span class=p>)</span> <span class=kr>do</span>
</span></span><span class="line hl"><span class=cl>        <span class=kd>local</span> <span class=n>expanded_path</span> <span class=o>=</span> <span class=n>input</span><span class=p>:</span><span class=n>gsub</span><span class=p>(</span><span class=n>alias</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
</span></span><span class="line hl"><span class=cl>        <span class=kd>local</span> <span class=n>real_path</span> <span class=o>=</span> <span class=n>find_file</span><span class=p>(</span><span class=n>expanded_path</span><span class=p>)</span> <span class=ow>or</span> <span class=n>find_dir</span><span class=p>(</span><span class=n>expanded_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>if</span> <span class=n>real_path</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>          <span class=kr>return</span> <span class=n>real_path</span>
</span></span><span class=line><span class=cl>        <span class=kr>end</span>
</span></span><span class=line><span class=cl>      <span class=kr>end</span>
</span></span><span class=line><span class=cl>    <span class=kr>end</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>input</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><h3 class="mb-8 mt-4 pt-4" id=handling-configuration-inheritance>Handling configuration inheritance
<a class="text-primary border-0" href=#handling-configuration-inheritance>#</a></h3><p>One problem though&mldr; We&rsquo;re ignoring TS Config&rsquo;s
<a href=https://www.typescriptlang.org/tsconfig#extends rel=external><code>extends</code><span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a> option, which
allows you to inherit from other configuration files.</p><p>If a <code>tsconfig.json</code> inherits from another configuration, our algorithm as it
is now just ignores these other configurations completely.</p><p>To handle this, we&rsquo;ll need to recursively call <code>get_tsconfig_paths</code> for every
<code>tsconfig.json</code> that has an <code>extends</code> option, until it doesn&rsquo;t:</p><div data-codeblock class="mt-16 [&_pre]:sm:rounded-tl-none
   group relative mb-8 [&_pre]:shadow [&_pre]:shadow-shadow [&_.highlight_pre]:[color-scheme:_dark]"><div data-codeblock-header class="absolute top-0 left-horizontal-padding mx-auto max-w-[calc(100%-var(--horizontal-padding)*2)] -translate-y-full overflow-hidden sm:left-0"><div class="chroma flex items-center gap-2 rounded-t border-t border-primary px-2 py-1"><div class=shrink-0><div class="h-[24px] w-[24px] [&>svg_*]:fill-current"><svg width="24" height="24" id="lua-plain-Ebene_1" xmlns="http://www.w3.org/2000/svg width=" height="24" viewBox="0 0 128 128"><style/><path fill="navy" d="M127.3 15.1c0-7.9-6.4-14.3-14.3-14.3S98.6 7.1 98.6 15.1 105 29.4 113 29.4s14.3-6.4 14.3-14.3"/><path fill="navy" d="M64 15.1c-27 0-49 21.9-49 49s21.9 49 49 49 49-21.9 49-49-22-49-49-49zm6 28.6c0-7.9 6.4-14.3 14.3-14.3s14.3 6.4 14.3 14.3S92.2 58 84.3 58 70 51.6 70 43.7zM66.3 128l-.1-1.5c1.8-.1 3.6-.2 5.4-.4l.2 1.5c-1.8.2-3.7.3-5.5.4zm-5.6.0c-1.9-.1-3.7-.3-5.6-.5l.2-1.5c1.8.2 3.6.4 5.4.5v1.5zm16.6-1.4-.3-1.4c1.8-.4 3.5-.8 5.3-1.4l.4 1.4c-1.7.6-3.5 1.1-5.4 1.4zm-27.7-.2c-1.8-.4-3.6-.9-5.4-1.5l.5-1.4c1.7.6 3.5 1 5.3 1.5l-.4 1.4zm38.4-3-.6-1.4c1.7-.7 3.3-1.4 5-2.3l.7 1.3c-1.7.9-3.4 1.7-5.1 2.4zm-49-.4c-1.7-.7-3.4-1.5-5-2.4l.7-1.3c1.6.9 3.3 1.6 4.9 2.4L39 123zm59-4.7-.8-1.2c1.5-1 3-2 4.5-3.1l.9 1.2c-1.5 1.1-3.1 2.1-4.6 3.1zm-68.8-.6c-1.6-1-3.1-2.1-4.5-3.2l.9-1.2c1.4 1.1 2.9 2.2 4.4 3.2l-.8 1.2zm77.7-6.1-1-1.1c1.3-1.2 2.7-2.5 3.9-3.8l1.1 1c-1.3 1.3-2.7 2.6-4 3.9zm-86.5-.7c-1.4-1.3-2.7-2.6-3.9-4l1.1-1c1.2 1.3 2.5 2.7 3.8 3.9l-1 1.1zm94.1-7.5-1.2-.9c1.1-1.4 2.2-2.9 3.2-4.4l1.2.8c-1 1.5-2.1 3.1-3.2 4.5zm-101.6-.8c-1.1-1.5-2.2-3-3.2-4.6l1.2-.8c1 1.5 2 3 3.1 4.5l-1.1.9zm107.7-8.5-1.3-.7c.9-1.6 1.6-3.3 2.4-4.9l1.3.5-2.4 5.1zM7 93.1c-.8-1.7-1.6-3.4-2.3-5.1l1.3-.5c.7 1.7 1.4 3.3 2.3 5l-1.3.6zm117.9-9.3-1.4-.5c.6-1.7 1-3.5 1.5-5.3l1.4.3c-.4 1.9-.9 3.7-1.5 5.5zm-122.1-1c-.5-1.8-1-3.6-1.4-5.4l1.4-.3c.4 1.8.8 3.5 1.4 5.3l-1.4.4zm124.6-9.9-1.5-.2c.2-1.8.4-3.6.5-5.4l1.5.1c0 1.8-.2 3.7-.5 5.5zM.5 71.9C.2 70 .1 68.2.0 66.3l1.5-.1c.1 1.8.2 3.6.4 5.4l-1.4.3zm126-10.1c-.1-1.8-.2-3.6-.4-5.4l1.5-.2c.2 1.8.4 3.7.4 5.6h-1.5zm-125-1L0 60.7c.1-1.9.3-3.7.5-5.6l1.5.3c-.2 1.8-.4 3.6-.5 5.4zM125.2 51c-.4-1.8-.8-3.6-1.4-5.3l1.4-.4c.5 1.8 1 3.6 1.4 5.4l-1.4.3zM3 50l-1.4-.3c.4-1.8.9-3.6 1.5-5.4l1.4.5C3.9 46.5 3.4 48.2 3 50zm119-9.4c-.7-1.7-1.4-3.4-2.3-5l1.3-.7c.8 1.7 1.6 3.4 2.3 5.1l-1.3.6zm-115.6-1L5 39.1c.7-1.7 1.5-3.4 2.4-5l1.3.7c-.8 1.5-1.6 3.2-2.3 4.8zm5.1-9.6-1.2-.8c1-1.6 2.1-3.1 3.2-4.5l1.2.9c-1.2 1.4-2.2 2.9-3.2 4.4zm6.7-8.6-1.1-1c1.3-1.4 2.6-2.7 4-3.9l1 1.1c-1.4 1.2-2.7 2.5-3.9 3.8zm8.1-7.3-.9-1.2c1.5-1.1 3-2.2 4.6-3.2l.8 1.2c-1.6 1.1-3.1 2.1-4.5 3.2zm67-5.4c-1.6-.8-3.3-1.6-4.9-2.3l.5-1.4c1.7.7 3.4 1.5 5 2.4l-.6 1.3zm-57.8-.4L34.8 7c1.7-.8 3.4-1.6 5.1-2.3l.6 1.3c-1.7.7-3.4 1.5-5 2.3zm47.7-3.8c-1.7-.6-3.5-1-5.3-1.4l.3-1.4c1.8.4 3.6.9 5.4 1.5l-.4 1.3zm-37.6-.3-.4-1.4c1.8-.5 3.6-1 5.4-1.4l.3 1.4c-1.8.4-3.6.9-5.3 1.4zm27-2.2c-1.8-.2-3.6-.4-5.4-.5l.1-1.5c1.9.1 3.7.3 5.6.5L72.6 2zm-16.3-.1L56.1.4c1.8-.2 3.7-.4 5.6-.4l.1 1.5c-1.9.0-3.7.2-5.5.4z"/></svg width="24" height="24"></div></div><div>Lua</div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>find_tsconfig_extends</span><span class=p>(</span><span class=n>extends</span><span class=p>,</span> <span class=n>tsconfig_fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>extends</span> <span class=ow>or</span> <span class=n>vim.startswith</span><span class=p>(</span><span class=n>extends</span><span class=p>,</span> <span class=s2>&#34;@&#34;</span><span class=p>)</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>tsconfig_dir</span> <span class=o>=</span> <span class=n>get_dir</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span> <span class=n>vim.fn</span><span class=p>.</span><span class=n>simplify</span><span class=p>(</span><span class=n>tsconfig_dir</span> <span class=o>..</span> <span class=s2>&#34;/&#34;</span> <span class=o>..</span> <span class=n>extends</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class="line hl"><span class=cl><span class=kd>local</span> <span class=kr>function</span> <span class=nf>get_tsconfig_paths</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>,</span> <span class=n>prev_base_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=ow>not</span> <span class=n>tsconfig_fname</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>json</span> <span class=o>=</span> <span class=n>decode_json_with_comments</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>)</span>
</span></span><span class="line hl"><span class=cl>  <span class=kd>local</span> <span class=n>base_url</span> <span class=o>=</span> <span class=n>json</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span> <span class=ow>and</span> <span class=n>json.compilerOptions</span><span class=p>.</span><span class=n>baseUrl</span> <span class=ow>or</span> <span class=n>prev_base_url</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>local</span> <span class=n>alias_to_paths</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>-- ...</span>
</span></span><span class=line><span class=cl>
</span></span><span class="line hl"><span class=cl>  <span class=kd>local</span> <span class=n>tsconfig_extends</span> <span class=o>=</span> <span class=n>find_tsconfig_extends</span><span class=p>(</span><span class=n>json.extends</span><span class=p>,</span> <span class=n>get_dir</span><span class=p>(</span><span class=n>tsconfig_fname</span><span class=p>))</span>
</span></span><span class="line hl"><span class=cl>
</span></span><span class="line hl"><span class=cl>  <span class=kr>return</span> <span class=n>vim.tbl_extend</span><span class=p>(</span><span class=s2>&#34;force&#34;</span><span class=p>,</span> <span class=n>alias_to_paths</span><span class=p>,</span> <span class=n>get_tsconfig_paths</span><span class=p>(</span><span class=n>tsconfig_extends</span><span class=p>,</span> <span class=n>base_url</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=kr>end</span></span></span></code></pre></div><button data-copy-code-button class="dark
btn btn-icon btn-icon-action pointer-events-none absolute right-0 top-3 hidden -translate-x-1/2 bg-surface opacity-0 transition-opacity duration-500 group-hover:pointer-events-auto group-hover:opacity-100" aria-label="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard" id="clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button></div><h2 class="mb-8 mt-4 pt-4" id=conclusion>Conclusion
<a class="text-primary border-0" href=#conclusion>#</a></h2><p><a href=https://github.com/phelipetls/dotfiles/blob/84303bfdf877d1ded6b8287f83806ebb73af1cce/.config/nvim/lua/tsconfig.lua rel=external>You can check the full implementation
here<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>.
Be aware that this will likely change.</p><p>As I said earlier, Vim&rsquo;s built-in file navigation features are not the best
tool for the job but it does help me when tsserver/coc.nvim/watchman are being
slow, unreliable or making my computer fans go crazy.</p><p>Vim support for go-to-definition functionality
<a href=https://vimways.org/2018/death-by-a-thousand-files/ rel=external>does not stop at the
<code>includeexpr</code> option<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</span></a>, but
the API is cumbersome to use. I tried to get go-to-defintion working for
TypeScript by using <code>:h include-search</code> but had a hard time and eventually gave
up (the <code>v:fname</code> API is not enough for nested imports), but it&rsquo;s nice to have
a working <code>gf</code> at least&mldr; It&rsquo;s also a good idea to
<a href=https://github.com/tpope/vim-apathy/blame/master/after/ftplugin/javascript_apathy.vim rel=external>check out what the
vim-apathy plugin does for
JavaScript<span class="ml-1 [&_svg]:inline-block [&_svg]:h-[1em] [&_svg]:w-[1em] [&_svg]:align-text-top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span></a>
if you want to dive more deep into it.</p></div><aside><div data-toc-wrapper class="w-full sm:overflow-y-auto lg:sticky lg:top-[1rem] lg:max-h-[calc(100vh-1rem)] lg:pb-8 lg:pl-8"><div class="hidden lg:block"><div class="flex justify-between gap-2"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg><h2 class=m-0>Table of Contents</h2></div><div class="flex items-center transition-transform duration-100 ease-in group-open:rotate-180 lg:hidden"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></div></div><div class="mt-4
[&_a_*]:indent-0
          [&_nav_ol]:m-0
[&_nav_ol]:list-none
          [&_nav_ol]:indent-4
[&_nav_ol_ol]:indent-8
          [&_nav_ol_ol_ol]:indent-12
[&_nav_ol_ol_ol_ol]:indent-16
      [&_nav_ol_li]:relative
          [&_nav_ol_li]:before:absolute
[&_nav_ol_li]:before:top-0
         [&_nav_ol_li]:before:left-0
        [&_nav_ol_li]:before:h-full
        [&_nav_ol_li]:before:w-[1px]
       [&_nav_ol_li]:before:bg-divider
    [&_nav_ol_li]:before:content-['']
  [&_nav_ol_li_a]:block
          [&_nav_ol_li_a]:truncate
[&_nav_ol_li_a]:border-b-0
         [&_nav_ol_li_a]:transition-colors
  [&_nav_ol_li_a]:duration-500
       [&_nav_ol_li_a:hover]:bg-hover
     [&_nav_ol_li[data-active]]:before:bg-primary
[&_nav_ol_li[data-active]>a]:text-primary"><nav data-toc><ol><li><a href=#why-not-lsp>Why not LSP?</a></li><li><a href=#implementation-details>Implementation details</a><ol><li><a href=#finding-tsconfigjson>Finding <code>tsconfig.json</code></a></li><li><a href=#reading-json-with-comments>Reading JSON with comments</a></li><li><a href=#parsing-compileroptionspaths>Parsing <code>compilerOptions.paths</code></a></li><li><a href=#expand-tsconfig>Expand tsconfig</a></li><li><a href=#handling-configuration-inheritance>Handling configuration inheritance</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></div><details class="card group mb-8 max-w-prose px-horizontal-padding py-4 lg:hidden" aria-label="Table of Contents"><summary class=list-none><div class="flex justify-between gap-2"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg><h2 class=m-0>Table of Contents</h2></div><div class="flex items-center transition-transform duration-100 ease-in group-open:rotate-180 lg:hidden"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></div></div></summary><div class="mt-4
[&_ol]:m-0
          [&_ol]:list-outside
[&_ol]:px-horizontal-padding
       [&_ol_li:not(:first-child)]:mt-1"><nav data-toc><ol><li><a href=#why-not-lsp>Why not LSP?</a></li><li><a href=#implementation-details>Implementation details</a><ol><li><a href=#finding-tsconfigjson>Finding <code>tsconfig.json</code></a></li><li><a href=#reading-json-with-comments>Reading JSON with comments</a></li><li><a href=#parsing-compileroptionspaths>Parsing <code>compilerOptions.paths</code></a></li><li><a href=#expand-tsconfig>Expand tsconfig</a></li><li><a href=#handling-configuration-inheritance>Handling configuration inheritance</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></details></div></aside></div></article><div data-theme-copy-code-tooltip role=tooltip class="pointer-events-none absolute rounded border border-divider bg-surface px-2" style=opacity:0>Copied<div data-theme-copy-code-tooltip-arrow class="absolute h-[8px] w-[8px] rotate-45 border-r border-b border-divider bg-surface"></div></div><hr class="full-width-on-mobile mt-8"><div class="full-width-on-mobile sm:my-8"><nav class="flex items-stretch sm:gap-4" aria-label="Posts navigation"><a class="sm:card flex flex-none basis-1/2 flex-col gap-2 border-0 py-4 px-horizontal-padding transition-colors duration-500 hover:bg-hover" href=/posts/automating-svg-to-jsx-conversion-with-svgr/><span class=text-primary><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg></span>Automating SVG to JSX conversion with svgr</a><div class="border-l border-divider sm:hidden"></div><a class="sm:card flex flex-none basis-1/2 flex-col-reverse items-end justify-end gap-2 border-0 py-4 px-horizontal-padding text-right transition-colors duration-500 hover:bg-hover" href=/posts/improving-the-android-studio-experience-in-dwm/>Improving the Android Studio experience in dwm
<span class=text-primary><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span></a></nav></div><hr class="full-width-on-mobile mb-8"><template data-utterances-template><div class="grid place-items-center"><div data-utterances-loading role=progressbar class="[&_svg]:animate-spin [&_svg]:duration-[1500ms]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader"><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"/><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"/></svg></div><script src=https://utteranc.es/client.js data-repo=phelipetls/phelipetls.github.io data-issue-term=pathname crossorigin=anonymous data-theme=github-light async></script></div><hr class="mt-8 hidden sm:block"></template></div></main><footer class="mt-8 border-t border-divider bg-background sm:border-0"><div class="mx-auto flex w-full max-w-content flex-col items-center gap-2 px-horizontal-padding pt-4 pb-8 sm:justify-between"><nav aria-label=Contacts class="flex gap-2"><a id=contact-email class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=mailto:phelipe_teles@hotmail.com aria-label=E-mail><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a id=contact-linkedin class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=https://linkedin.com/in/phelipeteles aria-label=LinkedIn><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a id=contact-github class="rounded-full hover:bg-hover p-2 [&_svg]:hover:scale-105 [&_svg]:transition-[transform,colors] [&_svg]:duration-500 hover:text-primary border-0" href=https://github.com/phelipetls aria-label=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></nav><span class=text-center>All content is under a
<a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0</a>
license.</span></div></footer></div><script src=https://phelipetls.github.io/js/post-bundle.min.js></script></body></html>